import { AksjonspunktKode } from '@navikt/fp-kodeverk';
import type { Aksjonspunkt, VilkårType } from '@navikt/fp-types';

export const lagAksjonspunkt = (aksjonspunktKode: AksjonspunktKode, options?: Partial<Aksjonspunkt>): Aksjonspunkt => {
  const status = options?.status ?? 'OPPR';
  return {
    definisjon: aksjonspunktKode,
    kanLoses: status === 'OPPR',
    erAktivt: status === 'OPPR',
    begrunnelse: status === 'OPPR' ? undefined : 'Dette er en begrunnelse',
    aksjonspunktType: aksjonspunktKode.startsWith('6') ? 'MANU' : 'OVST',
    toTrinnsBehandling: aksjonspunktKoderMedToTrinnsBehandling.has(aksjonspunktKode),
    vilkarType: aksjonspunktKodeTilVilkårType[aksjonspunktKode],
    ...options,
    status,
  };
};

const aksjonspunktKoderMedToTrinnsBehandling = new Set([
  AksjonspunktKode.VURDER_OMSORGSOVERTAKELSEVILKÅRET,
  AksjonspunktKode.MANUELL_VURDERING_AV_SØKNADSFRISTVILKÅRET,
  AksjonspunktKode.AVKLAR_DEKNINGSGRAD,
  AksjonspunktKode.AVKLAR_OM_SØKER_HAR_MOTTATT_STØTTE,
  AksjonspunktKode.FASTSETT_BEREGNINGSGRUNNLAG_ARBEIDSTAKER_FRILANS,
  AksjonspunktKode.VURDER_VARIG_ENDRET_ELLER_NYOPPSTARTET_NÆRING_SELVSTENDIG_NÆRINGSDRIVENDE,
  AksjonspunktKode.MANUELL_VURDERING_AV_SØKNADSFRIST,
  AksjonspunktKode.FORDEL_BEREGNINGSGRUNNLAG,
  AksjonspunktKode.FASTSETT_BEREGNINGSGRUNNLAG_TIDSBEGRENSET_ARBEIDSFORHOLD,
  AksjonspunktKode.FASTSETT_BEREGNINGSGRUNNLAG_FOR_SN_NY_I_ARBEIDSLIVET,
  AksjonspunktKode.AVKLAR_AKTIVITETER,
  AksjonspunktKode.VURDER_FAKTA_FOR_ATFL_SN,
  AksjonspunktKode.VURDER_REFUSJON_BERGRUNN,
  AksjonspunktKode.FAKTA_UTTAK_INGEN_PERIODER,
  AksjonspunktKode.FAKTA_UTTAK_MANUELT_SATT_STARTDATO_ULIK_SØKNAD_STARTDATO,
  AksjonspunktKode.FAKTA_UTTAK_GRADERING_UKJENT_AKTIVITET,
  AksjonspunktKode.FAKTA_UTTAK_GRADERING_AKTIVITET_UTEN_BEREGNINGSGRUNNLAG,
  AksjonspunktKode.FASTSETT_UTTAKPERIODER,
  AksjonspunktKode.FASTSETT_UTTAK_STORTINGSREPRESENTANT,
  AksjonspunktKode.KONTROLLER_REALITETSBEHANDLING_ELLER_KLAGE,
  AksjonspunktKode.KONTROLLER_OPPLYSNINGER_OM_DØD,
  AksjonspunktKode.KONTROLLER_OPPLYSNINGER_OM_SØKNADSFRIST,
  AksjonspunktKode.VURDER_OPPTJENINGSVILKÅRET,
  AksjonspunktKode.VURDER_FARESIGNALER,
  AksjonspunktKode.VURDER_UTTAK_DOKUMENTASJON,
  AksjonspunktKode.VURDER_MEDLEMSKAPSVILKÅRET,
  AksjonspunktKode.VURDER_FORUTGÅENDE_MEDLEMSKAPSVILKÅR,
  AksjonspunktKode.AVKLAR_UTTAK_I_EØS_FOR_ANNENPART,
  AksjonspunktKode.OVERSTYRING_AV_FØDSELSVILKÅRET,
  AksjonspunktKode.OVERSTYRING_AV_MEDLEMSKAPSVILKÅRET,
  AksjonspunktKode.OVERSTYRING_AV_SØKNADSFRISTVILKÅRET,
  AksjonspunktKode.OVERSTYRING_AV_UTTAKPERIODER,
  AksjonspunktKode.OVERSTYRING_AV_FØDSELSVILKÅRET_FAR_MEDMOR,
  AksjonspunktKode.OVERSTYRING_AV_OPPTJENINGSVILKÅRET,
  AksjonspunktKode.OVERSTYRING_FAKTA_UTTAK,
  AksjonspunktKode.OVERSTYRING_AV_BEREGNINGSAKTIVITETER,
  AksjonspunktKode.OVERSTYRING_AV_BEREGNINGSGRUNNLAG,
  AksjonspunktKode.OVERSTYRING_AV_AVKLART_STARTDATO,
  AksjonspunktKode.OVERSTYRING_AV_DEKNINGSGRAD,
  AksjonspunktKode.OVERSTYRING_AV_RETT_OG_OMSORG,
  AksjonspunktKode.OVERSTYRING_AV_FAKTA_OM_FØDSEL,
  AksjonspunktKode.OVERSTYRING_AV_FORUTGÅENDE_MEDLEMSKAPSVILKÅR,
  AksjonspunktKode.OVERSTYRING_AV_UTTAK_I_EØS_FOR_ANNENPART,
]);

const aksjonspunktKodeTilVilkårType: Partial<Record<AksjonspunktKode, VilkårType>> = {
  [AksjonspunktKode.SJEKK_TERMINBEKREFTELSE]: 'FP_VK_1',
  [AksjonspunktKode.SJEKK_MANGLENDE_FØDSEL]: 'FP_VK_1',
  [AksjonspunktKode.OVERSTYRING_AV_FØDSELSVILKÅRET]: 'FP_VK_1',
  [AksjonspunktKode.VURDER_MEDLEMSKAPSVILKÅRET]: 'FP_VK_2',
  [AksjonspunktKode.OVERSTYRING_AV_MEDLEMSKAPSVILKÅRET]: 'FP_VK_2',
  [AksjonspunktKode.OVERSTYRING_AV_AVKLART_STARTDATO]: 'FP_VK_2',
  [AksjonspunktKode.VURDER_FORUTGÅENDE_MEDLEMSKAPSVILKÅR]: 'FP_VK_2_F',
  [AksjonspunktKode.OVERSTYRING_AV_FORUTGÅENDE_MEDLEMSKAPSVILKÅR]: 'FP_VK_2_F',
  [AksjonspunktKode.OVERSTYRING_AV_SØKNADSFRISTVILKÅRET]: 'FP_VK_3',
  [AksjonspunktKode.MANUELL_VURDERING_AV_SØKNADSFRISTVILKÅRET]: 'FP_VK_3',
  [AksjonspunktKode.VURDER_OMSORGSOVERTAKELSEVILKÅRET]: 'FP_VK_6',
  [AksjonspunktKode.OVERSTYRING_AV_FØDSELSVILKÅRET_FAR_MEDMOR]: 'FP_VK_11',
  [AksjonspunktKode.VURDER_PERIODER_MED_OPPTJENING]: 'FP_VK_23',
  [AksjonspunktKode.VURDER_OPPTJENINGSVILKÅRET]: 'FP_VK_23',
  [AksjonspunktKode.OVERSTYRING_AV_OPPTJENINGSVILKÅRET]: 'FP_VK_23',
  [AksjonspunktKode.SØKERS_OPPLYSNINGSPLIKT_MANU]: 'FP_VK_34',
  [AksjonspunktKode.SØKERS_OPPLYSNINGSPLIKT_OVST]: 'FP_VK_34',
  [AksjonspunktKode.FASTSETT_BEREGNINGSGRUNNLAG_ARBEIDSTAKER_FRILANS]: 'FP_VK_41',
  [AksjonspunktKode.VURDER_VARIG_ENDRET_ELLER_NYOPPSTARTET_NÆRING_SELVSTENDIG_NÆRINGSDRIVENDE]: 'FP_VK_41',
  [AksjonspunktKode.FASTSETT_BEREGNINGSGRUNNLAG_TIDSBEGRENSET_ARBEIDSFORHOLD]: 'FP_VK_41',
  [AksjonspunktKode.MANUELL_KONTROLL_AV_BESTEBEREGNING]: 'FP_VK_41',
  [AksjonspunktKode.MANUELL_VURDERING_AV_SVANGERSKAPSPENGERVILKÅRET]: 'SVP_VK_1',
};
