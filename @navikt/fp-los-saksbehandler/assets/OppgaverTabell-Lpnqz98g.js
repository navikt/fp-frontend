import{j as a,a as f,F as E}from"./jsx-runtime-CUEGZZF9.js";import{r as s}from"./index-DogsOklH.js";import{u as N,a as Y,Z as $,i as S,e as I,L as z,j as J,k as Q,x as W,l as p,C as j,q as X}from"./nb_NO-ipgnHic7.js";import{K as ee}from"./kodeverkTyper-4shgb08m.js";import{g as te}from"./kodeverkUtils-d7epiQ_o.js";import{T as ne}from"./useGlobalStateRestApiData-n3nAw5-C.js";import{B as re}from"./BehandlingPollingTimoutModal-NraeEOrY.js";import{O as ae}from"./OppgaveHandlingerMenu-Nlw0emOp.js";import{c as h,R as le,a as m,r as x}from"./fplosSaksbehandlerRestApi-0x2sV2N8.js";import{C as se}from"./ChevronRight-bEtt5syV.js";var ie=function(n,i){var l={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&i.indexOf(t)<0&&(l[t]=n[t]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(n);r<t.length;r++)i.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(n,t[r])&&(l[t[r]]=n[t[r]]);return l};const oe=s.forwardRef((n,i)=>{var{title:l,titleId:t}=n,r=ie(n,["title","titleId"]);let d=N();return d=l?t||"title-"+d:void 0,s.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",focusable:!1,role:"img",ref:i,"aria-labelledby":d},r),l?s.createElement("title",{id:d},l):null,s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 6c0-.69.56-1.25 1.25-1.25h12c.69 0 1.25.56 1.25 1.25v9c0 .69-.56 1.25-1.25 1.25H9a.75.75 0 0 0-.386.107L4.75 18.675V6ZM6 3.25A2.75 2.75 0 0 0 3.25 6v14a.75.75 0 0 0 1.136.643l4.822-2.893H18A2.75 2.75 0 0 0 20.75 15V6A2.75 2.75 0 0 0 18 3.25H6Zm3 6.5a.75.75 0 0 0 0 1.5h.01a.75.75 0 0 0 0-1.5H9Zm2.25.75a.75.75 0 0 1 .75-.75h.01a.75.75 0 0 1 0 1.5H12a.75.75 0 0 1-.75-.75ZM15 9.75a.75.75 0 0 0 0 1.5h.01a.75.75 0 0 0 0-1.5H15Z",fill:"currentColor"}))}),de=oe;var ce=function(n,i){var l={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&i.indexOf(t)<0&&(l[t]=n[t]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,t=Object.getOwnPropertySymbols(n);r<t.length;r++)i.indexOf(t[r])<0&&Object.prototype.propertyIsEnumerable.call(n,t[r])&&(l[t[r]]=n[t[r]]);return l};const ue=s.forwardRef((n,i)=>{var{title:l,titleId:t}=n,r=ce(n,["title","titleId"]);let d=N();return d=l?t||"title-"+d:void 0,s.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",focusable:!1,role:"img",ref:i,"aria-labelledby":d},r),l?s.createElement("title",{id:d},l):null,s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.75 6a.75.75 0 0 1 .75-.75h17a.75.75 0 0 1 0 1.5h-17A.75.75 0 0 1 2.75 6Zm0 6a.75.75 0 0 1 .75-.75h17a.75.75 0 0 1 0 1.5h-17a.75.75 0 0 1-.75-.75Zm.75 5.25a.75.75 0 0 0 0 1.5h17a.75.75 0 0 0 0-1.5h-17Z",fill:"currentColor"}))}),ge=ue,pe="_isUnderBehandling_dynx0_1",fe="_image_dynx0_5",me="_noPadding_dynx0_12",ve="_bubbleIcon_dynx0_16",he="_chevronImage_dynx0_22",v={isUnderBehandling:pe,image:fe,noPadding:me,bubbleIcon:ve,chevronImage:he},be=["OppgaverTabell.Soker","OppgaverTabell.Behandlingstype","OppgaverTabell.BehandlingOpprettet","OppgaverTabell.FristForBehandling","EMPTY_1","EMPTY_2"],M=[],Oe=(n,i)=>{const l=n.filter(r=>!i.some(d=>d.id===r.id)).map(r=>({...r,underBehandling:!0})),t=i.map(r=>({...r,underBehandling:!1}));return l.concat(t.slice(0,3))},k=(n,i)=>n.underBehandling?()=>i(n):void 0,T=({reserverOppgave:n,antallOppgaver:i=0,valgtSakslisteId:l,doPolling:t=!0})=>{const r=Y(),[d,H]=s.useState(!1),[b,V]=s.useState(),[C,L]=s.useState({left:0,top:0}),q=h.useGlobalStateRestApiData(le.KODEVERK_LOS),{startRequest:G}=h.useRestApiRunner(m.FORLENG_OPPGAVERESERVASJON),{startRequest:O,data:R=M}=h.useRestApiRunner(m.RESERVERTE_OPPGAVER),{startRequest:D,data:P=M,error:K}=h.useRestApiRunner(m.OPPGAVER_TIL_BEHANDLING),A=(e,o,c)=>{O(void 0,!0),D(c?{sakslisteId:o,oppgaveIder:c}:{sakslisteId:o},e).then(g=>!g||typeof g=="string"||!t?Promise.resolve():A(!0,o,g.map(U=>U.id).join(","))).catch(()=>{})};s.useEffect(()=>{x.cancelRequest(m.OPPGAVER_TIL_BEHANDLING.name),A(!1,l)},[l]),s.useEffect(()=>()=>{x.cancelRequest(m.OPPGAVER_TIL_BEHANDLING.name)},[]);const Z=s.useCallback(e=>G({oppgaveId:e}).then(()=>O(void 0,!0)),[]),u=s.useRef({}),B=s.useCallback((e,o,c)=>{u.current&&Object.keys(u.current).some(g=>u.current[g]&&u.current[g].contains(e.target))||c&&n(c)},[u.current]),y=s.useCallback(e=>{var c;const o=(c=u.current[e.id])==null?void 0:c.getBoundingClientRect();H(!d),V(e.id),o&&L({top:o.top,left:o.left})},[u.current,d]),F=s.useCallback(e=>{const{flyttetReservasjon:o}=e;if(!o)return;const c=$(o.tidspunkt),g={dato:c==null?void 0:c.date,tid:c==null?void 0:c.time,uid:o.uid,navn:o.navn,beskrivelse:o.begrunnelse,br:a("br",{})};return a(S,{size:"small",children:a(I,{id:"OppgaverTabell.OverfortReservasjonTooltip",values:g})})},[]),_=s.useMemo(()=>Oe(R,P),[R,P]),w=R.find(e=>e.id===b);return f(E,{children:[K instanceof ne&&a(re,{}),a(z,{size:"small",children:a(I,{id:"OppgaverTabell.DineNesteSaker",values:{antall:i}})}),_.length===0&&f(E,{children:[a(J,{eightPx:!0}),a(S,{size:"small",children:a(I,{id:"OppgaverTabell.IngenOppgaver"})})]}),_.length>0&&f(E,{children:[a(Q,{headerTextCodes:be,children:_.map(e=>f(W,{onMouseDown:B,onKeyDown:B,className:e.underBehandling?v.isUnderBehandling:void 0,model:e,children:[a(p,{children:e.navn?`${e.navn} ${e.personnummer}`:"<navn>"}),a(p,{children:te(q,ee.BEHANDLING_TYPE,e.behandlingstype)}),a(p,{children:e.opprettetTidspunkt&&a(j,{dateString:e.opprettetTidspunkt})}),a(p,{children:e.behandlingsfrist&&a(j,{dateString:e.behandlingsfrist})}),a(p,{children:e.status.flyttetReservasjon&&a(X,{content:F(e.status),alignLeft:!0,children:a(de,{className:v.bubbleIcon})})}),f(p,{className:e.underBehandling?v.noPadding:void 0,children:[!e.underBehandling&&a(se,{className:v.chevronImage}),e.underBehandling&&a("div",{ref:o=>{u.current={...u.current,[e.id]:o}},children:a(ge,{className:v.image,title:r.formatMessage({id:"OppgaverTabell.OppgaveHandlinger"}),onMouseDown:k(e,y),onKeyDown:k(e,y)})})]})]},e.id))}),d&&b&&w&&a(ae,{imageNode:u.current[b],toggleMenu:y,offset:C,oppgave:w,forlengOppgaveReservasjon:Z,hentReserverteOppgaver:O})]})]})},Se=T;try{T.displayName="OppgaverTabell",T.__docgenInfo={description:"OppgaverTabell",displayName:"OppgaverTabell",props:{reserverOppgave:{defaultValue:null,description:"",name:"reserverOppgave",required:!0,type:{name:"(oppgave: Readonly<{ id: number; status: Readonly<{ erReservert: boolean; reservertTilTidspunkt?: string | undefined; erReservertAvInnloggetBruker?: boolean | undefined; reservertAvUid?: string | undefined; reservertAvNavn?: string | undefined; flyttetReservasjon?: { ...; } | undefined; }>; ... 10 more ...; behandli..."}},antallOppgaver:{defaultValue:{value:"0"},description:"",name:"antallOppgaver",required:!1,type:{name:"number"}},valgtSakslisteId:{defaultValue:null,description:"",name:"valgtSakslisteId",required:!0,type:{name:"number"}},doPolling:{defaultValue:{value:"true"},description:"",name:"doPolling",required:!1,type:{name:"boolean"}}}}}catch{}export{Se as O};
