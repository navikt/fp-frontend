import{a as P,F as T,j as S}from"./jsx-runtime-CUEGZZF9.js";import{r}from"./index-DogsOklH.js";import{e as j,E as q,g as M}from"./useGlobalStateRestApiData-n3nAw5-C.js";import{F as V}from"./FagsakSearch-DRxaM3Ev.js";import{c as u,a as k}from"./fplosSaksbehandlerRestApi-_SSph0Id.js";import{O as N}from"./OppgaveErReservertAvAnnenModal-m9x4ZgPD.js";const C=[],H=[],m=({åpneFagsak:t,kanSaksbehandle:p})=>{const[E,F]=r.useState(!1),[O,c]=r.useState(!1),[d,g]=r.useState(),[_,o]=r.useState(!1),[R,l]=r.useState(!1),{startRequest:I}=u.useRestApiRunner(k.RESERVER_OPPGAVE),{startRequest:b,resetRequestData:A,data:i=C,error:f}=u.useRestApiRunner(k.SEARCH_FAGSAK),{startRequest:x,data:a=H}=u.useRestApiRunner(k.OPPGAVER_FOR_FAGSAKER),{startRequest:y}=u.useRestApiRunner(k.HENT_RESERVASJONSSTATUS),G=f&&j(q.MANGLER_TILGANG_FEIL,f)?M(f):void 0;r.useEffect(()=>{R&&i.length===1&&(a.length===1?v(a[0],!1):a.length===0&&t(i[0].saksnummer))},[R,i,a]),r.useEffect(()=>()=>{A()},[]);const h=(e,s)=>{s&&(!s.erReservert||s.erReservert&&s.erReservertAvInnloggetBruker)?t(e.saksnummer.toString(),e.behandlingId):s&&s.erReservert&&!s.erReservertAvInnloggetBruker&&(g(e),c(!0))},v=(e,s)=>{e.status.erReservert&&!e.status.erReservertAvInnloggetBruker?(g(e),c(!0)):E?I({oppgaveId:e.id}).then(n=>{h(e,n)}):s?y({oppgaveId:e.id}).then(n=>{h(e,n)}):t(e.saksnummer.toString(),e.behandlingId)};return P(T,{children:[S(V,{fagsaker:i||[],fagsakOppgaver:a||[],searchFagsakCallback:e=>(F(e.skalReservere),o(!0),l(!1),b(e).then(s=>{s&&s.length>0?x({saksnummerListe:s.map(n=>`${n.saksnummer}`).join(",")}).then(()=>{o(!1),l(!0)}):(o(!1),l(!0))})),searchResultReceived:R,åpneFagsak:t,selectOppgaveCallback:e=>{v(e,!0)},searchStarted:_,searchResultAccessDenied:G,resetSearch:()=>{A(),o(!1),l(!1)},kanSaksbehandle:p}),O&&d&&S(N,{lukkErReservertModalOgOpneOppgave:e=>{g(void 0),c(!1),t(e.saksnummer.toString(),e.behandlingId)},oppgave:d,oppgaveStatus:d.status})]})},Q=m;try{m.displayName="FagsakSearchIndex",m.__docgenInfo={description:`FagsakSearchIndex

Container komponent. Har ansvar for å vise søkeskjermbildet og å håndtere fagsaksøket
mot server og lagringen av resultatet i klientens state.`,displayName:"FagsakSearchIndex",props:{åpneFagsak:{defaultValue:null,description:"",name:"åpneFagsak",required:!0,type:{name:"(saksnummer: string, behandlingUuid?: string | undefined) => void"}},kanSaksbehandle:{defaultValue:null,description:"",name:"kanSaksbehandle",required:!0,type:{name:"boolean"}}}}}catch{}export{Q as F};
