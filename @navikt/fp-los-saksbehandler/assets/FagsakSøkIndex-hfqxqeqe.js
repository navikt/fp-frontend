import{j as n}from"./jsx-runtime-D_zvdyIk.js";import{r as c}from"./index-_2TAQcTa.js";import{u as a}from"./useMutation-CSOTvE6I.js";import{a as M,s as Y,g as w,b as B,r as H}from"./fplosSaksbehandlerApi-Cre-4QqW.js";import{O as q}from"./OppgaveErReservertAvAnnenModal-nZvOWuOP.js";import{F as C}from"./FagsakSøk-D0rwEKyl.js";const G=[],U=[],D=({åpneFagsak:t,kanSaksbehandle:v})=>{var u;const[f,R]=c.useState(!1),[h,i]=c.useState(!1),[o,g]=c.useState(),{mutateAsync:F}=a({mutationFn:H}),{mutateAsync:A,data:O=U,isPending:l}=a({mutationFn:w}),{mutateAsync:S,data:p=G,error:k,reset:b,isPending:y,isSuccess:P}=a({mutationFn:async e=>{const s=await Y(e.searchString,e.skalReservere);if(s.length===0)return[];const r=await A(s);return s.length===1&&(r.length===1?m(r[0],!1):r.length===0&&s&&t(s[0].saksnummer)),s}}),{mutateAsync:x}=a({mutationFn:B}),E=k instanceof M&&k.response.status===403?(u=k.response)==null?void 0:u.data:void 0,I=P&&!l,d=(e,s)=>{s&&(!s.erReservert||s.erReservert&&s.erReservertAvInnloggetBruker)?t(e.saksnummer.toString(),e.behandlingId):s!=null&&s.erReservert&&!s.erReservertAvInnloggetBruker&&(g(e),i(!0))},m=(e,s)=>{e.status.erReservert&&!e.status.erReservertAvInnloggetBruker?(g(e),i(!0)):f?F(e.id).then(r=>{d(e,r)}):s?x(e.id).then(r=>{d(e,r)}):t(e.saksnummer.toString(),e.behandlingId)},j=e=>{m(e,!0)},_=e=>(R(e.skalReservere),S(e)),T=e=>{g(void 0),i(!1),t(e.saksnummer.toString(),e.behandlingId)};return n.jsxs(n.Fragment,{children:[n.jsx(C,{fagsaker:p||[],fagsakOppgaver:O||[],searchFagsakCallback:_,searchResultReceived:I,åpneFagsak:t,selectOppgaveCallback:j,searchStarted:l||y,searchResultAccessDenied:E,resetSearch:b,kanSaksbehandle:v}),h&&o&&n.jsx(q,{lukkErReservertModalOgOpneOppgave:T,oppgave:o,oppgaveStatus:o.status})]})};D.__docgenInfo={description:`FagsakSøkIndex

Har ansvar for å vise søkeskjermbildet og å håndtere fagsaksøket
mot server og lagringen av resultatet i klientens state.`,methods:[],displayName:"FagsakSøkIndex",props:{åpneFagsak:{required:!0,tsType:{name:"signature",type:"function",raw:"(saksnummer: string, behandlingUuid?: string) => void",signature:{arguments:[{type:{name:"string"},name:"saksnummer"},{type:{name:"string"},name:"behandlingUuid"}],return:{name:"void"}}},description:""},kanSaksbehandle:{required:!0,tsType:{name:"boolean"},description:""}}};export{D as F};
