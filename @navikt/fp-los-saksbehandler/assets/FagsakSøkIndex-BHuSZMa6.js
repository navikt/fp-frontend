import{j as k}from"./jsx-runtime-QvZ8i92b.js";import{r}from"./index-uubelm5h.js";import{e as q,E as M,g as N}from"./useRestApiRunner-PStp57wB.js";import{F as V}from"./FagsakSøk-jdWU04iR.js";import{c as u,a as R}from"./fplosSaksbehandlerRestApi-BlHbvkr3.js";import{O as H}from"./OppgaveErReservertAvAnnenModal-ABJYG4zL.js";const K=[],L=[],Y=({åpneFagsak:t,kanSaksbehandle:E})=>{const[S,O]=r.useState(!1),[F,d]=r.useState(!1),[g,m]=r.useState(),[p,i]=r.useState(!1),[c,o]=r.useState(!1),{startRequest:I}=u.useRestApiRunner(R.RESERVER_OPPGAVE),{startRequest:_,resetRequestData:A,data:l=K,error:f}=u.useRestApiRunner(R.SEARCH_FAGSAK),{startRequest:b,data:n=L}=u.useRestApiRunner(R.OPPGAVER_FOR_FAGSAKER),{startRequest:T}=u.useRestApiRunner(R.HENT_RESERVASJONSSTATUS),x=f&&q(M.MANGLER_TILGANG_FEIL,f)?N(f):void 0;r.useEffect(()=>{c&&l.length===1&&(n.length===1?h(n[0],!1):n.length===0&&t(l[0].saksnummer))},[c,l,n]),r.useEffect(()=>()=>{A()},[]);const v=(e,s)=>{s&&(!s.erReservert||s.erReservert&&s.erReservertAvInnloggetBruker)?t(e.saksnummer.toString(),e.behandlingId):s!=null&&s.erReservert&&!s.erReservertAvInnloggetBruker&&(m(e),d(!0))},h=(e,s)=>{e.status.erReservert&&!e.status.erReservertAvInnloggetBruker?(m(e),d(!0)):S?I({oppgaveId:e.id}).then(a=>{v(e,a)}):s?T({oppgaveId:e.id}).then(a=>{v(e,a)}):t(e.saksnummer.toString(),e.behandlingId)},j=e=>{h(e,!0)},y=e=>(O(e.skalReservere),i(!0),o(!1),_(e).then(s=>{s&&s.length>0?b({saksnummerListe:s.map(a=>`${a.saksnummer}`).join(",")}).then(()=>{i(!1),o(!0)}):(i(!1),o(!0))})),G=e=>{m(void 0),d(!1),t(e.saksnummer.toString(),e.behandlingId)},P=()=>{A(),i(!1),o(!1)};return k.jsxs(k.Fragment,{children:[k.jsx(V,{fagsaker:l||[],fagsakOppgaver:n||[],searchFagsakCallback:y,searchResultReceived:c,åpneFagsak:t,selectOppgaveCallback:j,searchStarted:p,searchResultAccessDenied:x,resetSearch:P,kanSaksbehandle:E}),F&&g&&k.jsx(H,{lukkErReservertModalOgOpneOppgave:G,oppgave:g,oppgaveStatus:g.status})]})};Y.__docgenInfo={description:`FagsakSøkIndex

Har ansvar for å vise søkeskjermbildet og å håndtere fagsaksøket
mot server og lagringen av resultatet i klientens state.`,methods:[],displayName:"FagsakSøkIndex",props:{åpneFagsak:{required:!0,tsType:{name:"signature",type:"function",raw:"(saksnummer: string, behandlingUuid?: string) => void",signature:{arguments:[{type:{name:"string"},name:"saksnummer"},{type:{name:"string"},name:"behandlingUuid"}],return:{name:"void"}}},description:""},kanSaksbehandle:{required:!0,tsType:{name:"boolean"},description:""}}};export{Y as F};
