import{j as n}from"./jsx-runtime-5926aa06.js";import{r as s}from"./index-ebeaab24.js";import{a as K,G as Y,h as A,F as j,L as J,J as $,i as z,k as Z,W as u,V as k,Z as y}from"./nb_NO-80ad4d83.js";import{J as W,t as Q}from"./index.es-4cd68a77.js";import{O as X}from"./index.es-d4f46e89.js";import{B as ee}from"./BehandlingPollingTimoutModal-4b237913.js";import{O as ne}from"./OppgaveHandlingerMenu-29cfdbd4.js";import{b as m,a as te,R as g,r as N}from"./fplosSaksbehandlerRestApi-325d6556.js";import{C as re}from"./ChevronRight-93858554.js";const se=""+new URL("ic-menu-18px_blue-ca77835c.svg",import.meta.url).href,ae=""+new URL("ic-menu-18px_black-f72f064e.svg",import.meta.url).href,le=""+new URL("bubbletext-1319c908.svg",import.meta.url).href,ie=""+new URL("bubbletext_filled-a73a277e.svg",import.meta.url).href,oe="_isUnderBehandling_8jm4o_1",de="_image_8jm4o_5",ue="_noPadding_8jm4o_9",x={isUnderBehandling:oe,image:de,noPadding:ue},ce=["OppgaverTabell.Soker","OppgaverTabell.Behandlingstype","OppgaverTabell.BehandlingOpprettet","OppgaverTabell.FristForBehandling","EMPTY_1","EMPTY_2"],S=[],ge=(o,d)=>{const p=o.filter(l=>!d.some(c=>c.id===l.id)).map(l=>({...l,underBehandling:!0})),f=d.map(l=>({...l,underBehandling:!1}));return p.concat(f.slice(0,3))},M=(o,d)=>o.underBehandling?()=>d(o):void 0,_=({reserverOppgave:o,antallOppgaver:d=0,valgtSakslisteId:p,doPolling:f=!0})=>{const l=K(),[c,L]=s.useState(!1),[v,V]=s.useState(),[G,I]=s.useState({left:0,top:0}),U=m.useGlobalStateRestApiData(te.KODEVERK_LOS),{startRequest:w}=m.useRestApiRunner(g.FORLENG_OPPGAVERESERVASJON),{startRequest:h,data:b=S}=m.useRestApiRunner(g.RESERVERTE_OPPGAVER),{startRequest:D,data:T=S,error:F}=m.useRestApiRunner(g.OPPGAVER_TIL_BEHANDLING),B=(e,t,r)=>{h(void 0,!0),D(r?{sakslisteId:t,oppgaveIder:r}:{sakslisteId:t},e).then(i=>!i||typeof i=="string"||!f?Promise.resolve():B(!0,t,i.map(C=>C.id).join(","))).catch(()=>{})};s.useEffect(()=>{N.cancelRequest(g.OPPGAVER_TIL_BEHANDLING.name),B(!1,p)},[p]),s.useEffect(()=>()=>{N.cancelRequest(g.OPPGAVER_TIL_BEHANDLING.name)},[]);const q=s.useCallback(e=>w({oppgaveId:e}).then(()=>h(void 0,!0)),[]),a=s.useRef({}),E=s.useCallback((e,t,r)=>{a.current&&Object.keys(a.current).some(i=>a.current[i]&&a.current[i].contains(e.target))||r&&o(r)},[a.current]),R=s.useCallback(e=>{var r;const t=(r=a.current[e.id])==null?void 0:r.getBoundingClientRect();L(!c),V(e.id),t&&I({top:t.top,left:t.left})},[a.current,c]),H=s.useCallback(e=>{const{flyttetReservasjon:t}=e;if(!t)return;const r=Y(t.tidspunkt),i={dato:r==null?void 0:r.date,tid:r==null?void 0:r.time,uid:t.uid,navn:t.navn,beskrivelse:t.begrunnelse,br:n.jsx("br",{})};return n.jsx(A,{size:"small",children:n.jsx(j,{id:"OppgaverTabell.OverfortReservasjonTooltip",values:i})})},[]),O=s.useMemo(()=>ge(b,T),[b,T]),P=b.find(e=>e.id===v);return n.jsxs(n.Fragment,{children:[F instanceof X&&n.jsx(ee,{}),n.jsx(J,{size:"small",children:n.jsx(j,{id:"OppgaverTabell.DineNesteSaker",values:{antall:d}})}),O.length===0&&n.jsxs(n.Fragment,{children:[n.jsx($,{eightPx:!0}),n.jsx(A,{size:"small",children:n.jsx(j,{id:"OppgaverTabell.IngenOppgaver"})})]}),O.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(z,{headerTextCodes:ce,children:O.map(e=>n.jsxs(Z,{onMouseDown:E,onKeyDown:E,className:e.underBehandling?x.isUnderBehandling:void 0,model:e,children:[n.jsx(u,{children:e.navn?`${e.navn} ${e.personnummer}`:"<navn>"}),n.jsx(u,{children:W(U,Q.BEHANDLING_TYPE,e.behandlingstype)}),n.jsx(u,{children:e.opprettetTidspunkt&&n.jsx(k,{dateString:e.opprettetTidspunkt})}),n.jsx(u,{children:e.behandlingsfrist&&n.jsx(k,{dateString:e.behandlingsfrist})}),n.jsx(u,{children:e.status.flyttetReservasjon&&n.jsx(y,{src:le,srcHover:ie,alt:l.formatMessage({id:"OppgaverTabell.OverfortReservasjon"}),tooltip:H(e.status),alignTooltipLeft:!0})}),n.jsxs(u,{className:e.underBehandling?x.noPadding:void 0,children:[!e.underBehandling&&n.jsx(re,{}),e.underBehandling&&n.jsx("div",{ref:t=>{a.current={...a.current,[e.id]:t}},children:n.jsx(y,{className:x.image,src:ae,srcHover:se,alt:l.formatMessage({id:"OppgaverTabell.OppgaveHandlinger"}),onMouseDown:M(e,R),onKeyDown:M(e,R)})})]})]},e.id))}),c&&v&&P&&n.jsx(ne,{imageNode:a.current[v],toggleMenu:R,offset:G,oppgave:P,forlengOppgaveReservasjon:q,hentReserverteOppgaver:h})]})]})},xe=_;try{_.displayName="OppgaverTabell",_.__docgenInfo={description:"OppgaverTabell",displayName:"OppgaverTabell",props:{reserverOppgave:{defaultValue:null,description:"",name:"reserverOppgave",required:!0,type:{name:"(oppgave: Readonly<{ id: number; status: Readonly<{ erReservert: boolean; reservertTilTidspunkt?: string | undefined; erReservertAvInnloggetBruker?: boolean | undefined; reservertAvUid?: string | undefined; reservertAvNavn?: string | undefined; flyttetReservasjon?: { ...; } | undefined; }>; ... 10 more ...; behandli..."}},antallOppgaver:{defaultValue:{value:"0"},description:"",name:"antallOppgaver",required:!1,type:{name:"number"}},valgtSakslisteId:{defaultValue:null,description:"",name:"valgtSakslisteId",required:!0,type:{name:"number"}},doPolling:{defaultValue:{value:"true"},description:"",name:"doPolling",required:!1,type:{name:"boolean"}}}}}catch{}export{xe as O};
//# sourceMappingURL=OppgaverTabell-46f3a11e.js.map
