import{j as n}from"./jsx-runtime-9c4ae004.js";import{r as s}from"./index-1b03fe98.js";import{u as M,a as K,G as U,h as P,e as j,L as Y,g as $,k as z,x as J,H as p,l as A,q as Q}from"./nb_NO-158985cd.js";import{l as W,J as X}from"./index.es-c5fcd9dd.js";import{O as ee}from"./index.es-06c0167b.js";import{B as te}from"./BehandlingPollingTimoutModal-6584c705.js";import{O as ne}from"./OppgaveHandlingerMenu-6c5cd5b7.js";import{a as h,b as re,R as m,r as B}from"./fplosSaksbehandlerRestApi-31142b17.js";import{C as ae}from"./ChevronRight-0702b3ba.js";var le=globalThis&&globalThis.__rest||function(r,i){var l={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&i.indexOf(t)<0&&(l[t]=r[t]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,t=Object.getOwnPropertySymbols(r);a<t.length;a++)i.indexOf(t[a])<0&&Object.prototype.propertyIsEnumerable.call(r,t[a])&&(l[t[a]]=r[t[a]]);return l};const se=s.forwardRef((r,i)=>{var{title:l,titleId:t}=r,a=le(r,["title","titleId"]);let d=M();return d=l?t||"title-"+d:void 0,s.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",focusable:!1,role:"img",ref:i,"aria-labelledby":d},a),l?s.createElement("title",{id:d},l):null,s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4.75 6c0-.69.56-1.25 1.25-1.25h12c.69 0 1.25.56 1.25 1.25v9c0 .69-.56 1.25-1.25 1.25H9a.75.75 0 0 0-.386.107L4.75 18.675V6ZM6 3.25A2.75 2.75 0 0 0 3.25 6v14a.75.75 0 0 0 1.136.643l4.822-2.893H18A2.75 2.75 0 0 0 20.75 15V6A2.75 2.75 0 0 0 18 3.25H6Zm3 6.5a.75.75 0 0 0 0 1.5h.01a.75.75 0 0 0 0-1.5H9Zm2.25.75a.75.75 0 0 1 .75-.75h.01a.75.75 0 0 1 0 1.5H12a.75.75 0 0 1-.75-.75ZM15 9.75a.75.75 0 0 0 0 1.5h.01a.75.75 0 0 0 0-1.5H15Z",fill:"currentColor"}))}),ie=se;var oe=globalThis&&globalThis.__rest||function(r,i){var l={};for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&i.indexOf(t)<0&&(l[t]=r[t]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,t=Object.getOwnPropertySymbols(r);a<t.length;a++)i.indexOf(t[a])<0&&Object.prototype.propertyIsEnumerable.call(r,t[a])&&(l[t[a]]=r[t[a]]);return l};const de=s.forwardRef((r,i)=>{var{title:l,titleId:t}=r,a=oe(r,["title","titleId"]);let d=M();return d=l?t||"title-"+d:void 0,s.createElement("svg",Object.assign({width:"1em",height:"1em",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",focusable:!1,role:"img",ref:i,"aria-labelledby":d},a),l?s.createElement("title",{id:d},l):null,s.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M2.75 6a.75.75 0 0 1 .75-.75h17a.75.75 0 0 1 0 1.5h-17A.75.75 0 0 1 2.75 6Zm0 6a.75.75 0 0 1 .75-.75h17a.75.75 0 0 1 0 1.5h-17a.75.75 0 0 1-.75-.75Zm.75 5.25a.75.75 0 0 0 0 1.5h17a.75.75 0 0 0 0-1.5h-17Z",fill:"currentColor"}))}),ce=de,ue="_isUnderBehandling_dynx0_1",ge="_image_dynx0_5",pe="_noPadding_dynx0_12",me="_bubbleIcon_dynx0_16",fe="_chevronImage_dynx0_22",f={isUnderBehandling:ue,image:ge,noPadding:pe,bubbleIcon:me,chevronImage:fe},he=["OppgaverTabell.Soker","OppgaverTabell.Behandlingstype","OppgaverTabell.BehandlingOpprettet","OppgaverTabell.FristForBehandling","EMPTY_1","EMPTY_2"],w=[],ve=(r,i)=>{const l=r.filter(a=>!i.some(d=>d.id===a.id)).map(a=>({...a,underBehandling:!0})),t=i.map(a=>({...a,underBehandling:!1}));return l.concat(t.slice(0,3))},S=(r,i)=>r.underBehandling?()=>i(r):void 0,y=({reserverOppgave:r,antallOppgaver:i=0,valgtSakslisteId:l,doPolling:t=!0})=>{const a=K(),[d,N]=s.useState(!1),[v,k]=s.useState(),[H,V]=s.useState({left:0,top:0}),G=h.useGlobalStateRestApiData(re.KODEVERK_LOS),{startRequest:L}=h.useRestApiRunner(m.FORLENG_OPPGAVERESERVASJON),{startRequest:b,data:O=w}=h.useRestApiRunner(m.RESERVERTE_OPPGAVER),{startRequest:C,data:_=w,error:q}=h.useRestApiRunner(m.OPPGAVER_TIL_BEHANDLING),E=(e,o,c)=>{b(void 0,!0),C(c?{sakslisteId:o,oppgaveIder:c}:{sakslisteId:o},e).then(g=>!g||typeof g=="string"||!t?Promise.resolve():E(!0,o,g.map(Z=>Z.id).join(","))).catch(()=>{})};s.useEffect(()=>{B.cancelRequest(m.OPPGAVER_TIL_BEHANDLING.name),E(!1,l)},[l]),s.useEffect(()=>()=>{B.cancelRequest(m.OPPGAVER_TIL_BEHANDLING.name)},[]);const D=s.useCallback(e=>L({oppgaveId:e}).then(()=>b(void 0,!0)),[]),u=s.useRef({}),T=s.useCallback((e,o,c)=>{u.current&&Object.keys(u.current).some(g=>u.current[g]&&u.current[g].contains(e.target))||c&&r(c)},[u.current]),x=s.useCallback(e=>{var c;const o=(c=u.current[e.id])==null?void 0:c.getBoundingClientRect();N(!d),k(e.id),o&&V({top:o.top,left:o.left})},[u.current,d]),F=s.useCallback(e=>{const{flyttetReservasjon:o}=e;if(!o)return;const c=U(o.tidspunkt),g={dato:c==null?void 0:c.date,tid:c==null?void 0:c.time,uid:o.uid,navn:o.navn,beskrivelse:o.begrunnelse,br:n.jsx("br",{})};return n.jsx(P,{size:"small",children:n.jsx(j,{id:"OppgaverTabell.OverfortReservasjonTooltip",values:g})})},[]),R=s.useMemo(()=>ve(O,_),[O,_]),I=O.find(e=>e.id===v);return n.jsxs(n.Fragment,{children:[q instanceof ee&&n.jsx(te,{}),n.jsx(Y,{size:"small",children:n.jsx(j,{id:"OppgaverTabell.DineNesteSaker",values:{antall:i}})}),R.length===0&&n.jsxs(n.Fragment,{children:[n.jsx($,{eightPx:!0}),n.jsx(P,{size:"small",children:n.jsx(j,{id:"OppgaverTabell.IngenOppgaver"})})]}),R.length>0&&n.jsxs(n.Fragment,{children:[n.jsx(z,{headerTextCodes:he,children:R.map(e=>n.jsxs(J,{onMouseDown:T,onKeyDown:T,className:e.underBehandling?f.isUnderBehandling:void 0,model:e,children:[n.jsx(p,{children:e.navn?`${e.navn} ${e.personnummer}`:"<navn>"}),n.jsx(p,{children:W(G,X.BEHANDLING_TYPE,e.behandlingstype)}),n.jsx(p,{children:e.opprettetTidspunkt&&n.jsx(A,{dateString:e.opprettetTidspunkt})}),n.jsx(p,{children:e.behandlingsfrist&&n.jsx(A,{dateString:e.behandlingsfrist})}),n.jsx(p,{children:e.status.flyttetReservasjon&&n.jsx(Q,{content:F(e.status),alignLeft:!0,children:n.jsx(ie,{className:f.bubbleIcon})})}),n.jsxs(p,{className:e.underBehandling?f.noPadding:void 0,children:[!e.underBehandling&&n.jsx(ae,{className:f.chevronImage}),e.underBehandling&&n.jsx("div",{ref:o=>{u.current={...u.current,[e.id]:o}},children:n.jsx(ce,{className:f.image,title:a.formatMessage({id:"OppgaverTabell.OppgaveHandlinger"}),onMouseDown:S(e,x),onKeyDown:S(e,x)})})]})]},e.id))}),d&&v&&I&&n.jsx(ne,{imageNode:u.current[v],toggleMenu:x,offset:H,oppgave:I,forlengOppgaveReservasjon:D,hentReserverteOppgaver:b})]})]})},Ie=y;try{y.displayName="OppgaverTabell",y.__docgenInfo={description:"OppgaverTabell",displayName:"OppgaverTabell",props:{reserverOppgave:{defaultValue:null,description:"",name:"reserverOppgave",required:!0,type:{name:"(oppgave: Readonly<{ id: number; status: Readonly<{ erReservert: boolean; reservertTilTidspunkt?: string | undefined; erReservertAvInnloggetBruker?: boolean | undefined; reservertAvUid?: string | undefined; reservertAvNavn?: string | undefined; flyttetReservasjon?: { ...; } | undefined; }>; ... 10 more ...; behandli..."}},antallOppgaver:{defaultValue:{value:"0"},description:"",name:"antallOppgaver",required:!1,type:{name:"number"}},valgtSakslisteId:{defaultValue:null,description:"",name:"valgtSakslisteId",required:!0,type:{name:"number"}},doPolling:{defaultValue:{value:"true"},description:"",name:"doPolling",required:!1,type:{name:"boolean"}}}}}catch{}export{Ie as O};
//# sourceMappingURL=OppgaverTabell-906de65b.js.map
