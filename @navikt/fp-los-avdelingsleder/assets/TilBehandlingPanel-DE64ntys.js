import{p as d,j as s,z as K,s as v,B as o,h as O,C as j,A as L}from"./iframe-CYwBcPG7.js";import{b as V,D as G,M as P,F,R as f}from"./index.es-BvWi-h_e.js";import{u as U}from"./useQuery-DVAhYD1i.js";import{V as M,H as x,C as w}from"./fplosAvdelingslederApi-9kO9AmP4.js";import{S as _}from"./StoreValuesInLocalStorage-BWXcjOmh.js";import{u as E}from"./useLosKodeverk-DXFUTn3L.js";import{R as q}from"./FlyttReservasjonModal-CrdyiaIW.js";import{L as Y,M as S}from"./nb_NO-K-P2UlcY.js";const D=[o.TILBAKEKREVING_REVURDERING,o.TILBAKEKREVING,o.DOKUMENTINNSYN,o.KLAGE,o.REVURDERING,o.FORSTEGANGSSOKNAD],z={[o.TILBAKEKREVING_REVURDERING]:"#ef5d28",[o.TILBAKEKREVING]:"#ff842f",[o.DOKUMENTINNSYN]:"#ffd23b",[o.KLAGE]:"#826ba1",[o.REVURDERING]:"#3385d1",[o.FORSTEGANGSSOKNAD]:"#85d5f0",[o.ANKE]:"#85d5f0","-":"#85d5f0"},R=r=>Object.keys(r),A=({height:r,oppgaverPerDato:t,isToUkerValgt:e,behandlingTyper:n})=>{const a=d().subtract(e?2:4,"w").add(1,"d"),y=d(),c=C(t),l=H(c,a,y),u=n.map(i=>i.kode).sort(B),m=R(l).sort(B).slice().reverse(),p=u.map(i=>z[i]);return s.jsx(q,{height:r,option:{tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{formatter:i=>i.axisDimension==="y"?parseInt(i.value,10).toString():d(i.value).format(K)}}},toolbox:{feature:{saveAsImage:{title:"Lagre ",name:"Antall_til_behandling"}}},legend:{data:m.map(i=>N(n,i)),top:"top"},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"time",axisLabel:{formatter:"{dd}.{MM}.{yyyy}"}}],yAxis:[{type:"value"}],series:u.map(i=>({name:N(n,i),type:"line",stack:"stackname",areaStyle:{},emphasis:{focus:"series"},data:l[i]})),color:p}})},B=(r,t)=>{const e=D.findIndex(a=>a===r),n=D.findIndex(a=>a===t);return e===n?0:e>n?-1:1},N=(r,t)=>{const e=r.find(n=>n.kode===t);return e?e.navn:""},C=r=>r.reduce((t,e)=>{const n={x:d(e.opprettetDato).startOf("day").toDate(),y:e.antall},a=t[e.behandlingType];return{...t,[e.behandlingType]:a?a.concat(n):[n]}},{}),H=(r,t,e)=>R(r).reduce((n,a)=>{const y=r[a],c=[];for(let l=d(t);l.isSameOrBefore(e);l=l.add(1,"days")){const u=y.find(g=>d(g.x).startOf("day").isSame(l.startOf("day")));c.push(u?[d(u.x).format(v),u.y]:[l.format(v),0])}return{...n,[a]:c}},{});A.__docgenInfo={description:"",methods:[],displayName:"TilBehandlingGraf",props:{height:{required:!0,tsType:{name:"number"},description:""},behandlingTyper:{required:!0,tsType:{name:"Array",elements:[{name:"Readonly",elements:[{name:"signature",type:"object",raw:`{
  kode: EnumOrUnknown<T>;
  navn: string;
  kodeverk: string;
}`,signature:{properties:[{key:"kode",value:{name:"unknown",required:!0}},{key:"navn",value:{name:"string",required:!0}},{key:"kodeverk",value:{name:"string",required:!0}}]}}],raw:`Readonly<{
  kode: EnumOrUnknown<T>;
  navn: string;
  kodeverk: string;
}>`}],raw:"LosKodeverkMedNavn<'BehandlingType'>[]"},description:""},oppgaverPerDato:{required:!0,tsType:{name:"Array",elements:[{name:"OppgaveForDatoGraf"}],raw:"OppgaveForDatoGraf[]"},description:""},isToUkerValgt:{required:!0,tsType:{name:"boolean"},description:""}}};d.extend(j);d.extend(L);const k="ALLE",T="2",b="tilBehandlingForm",J={ytelseType:k,ukevalg:T},Q=({height:r,valgtAvdelingEnhet:t,getValueFromLocalStorage:e})=>{const n=O(),{data:a}=U(w(t)),y=E("BehandlingType"),c=E("FagsakYtelseType"),l=e(b),u=l?JSON.parse(l):void 0,g=V({defaultValues:u??J}),m=g.watch();return s.jsxs(G,{formMethods:g,children:[s.jsx(_,{stateKey:b,values:m}),s.jsxs(M,{gap:"space-16",children:[s.jsx(Y,{size:"small",children:s.jsx(S,{id:"TilBehandlingPanel.TilBehandling"})}),s.jsxs(x,{gap:"space-16",children:[s.jsx(P,{name:"ukevalg",control:g.control,label:"",selectValues:I.map(p=>s.jsx("option",{value:p.kode,children:n.formatMessage({id:p.tekstKode})},p.kode))}),s.jsx(F,{name:"ytelseType",control:g.control,children:s.jsxs(x,{gap:"space-16",children:[s.jsx(f,{value:"FP",size:"small",children:h(c,"FP")}),s.jsx(f,{value:"ES",size:"small",children:h(c,"ES")}),s.jsx(f,{value:"SVP",size:"small",children:h(c,"SVP")}),s.jsx(f,{value:k,size:"small",children:s.jsx(S,{id:"TilBehandlingPanel.Alle"})})]})})]}),s.jsx(A,{height:r,isToUkerValgt:m.ukevalg===T,behandlingTyper:y,oppgaverPerDato:a?X(a.filter(p=>m.ytelseType===k?!0:m.ytelseType===p.fagsakYtelseType).filter(p=>W(p,m.ukevalg))):[]})]})]})},I=[{kode:T,tekstKode:"TilBehandlingPanel.ToSisteUker"},{kode:"4",tekstKode:"TilBehandlingPanel.FireSisteUker"}],W=(r,t)=>{if(t===I[1].kode)return!0;const e=d().subtract(2,"w");return d(r.opprettetDato).isSameOrAfter(e)},h=(r,t)=>{const e=r.find(n=>n.kode===t);return e?e.navn:""},X=r=>{const t=[];return r.forEach(e=>{const n=t.findIndex(a=>a.behandlingType===e.behandlingType&&a.opprettetDato===e.opprettetDato);n===-1?t.push(e):t[n]={behandlingType:t[n].behandlingType,opprettetDato:t[n].opprettetDato,antall:t[n].antall+e.antall}}),t};Q.__docgenInfo={description:"",methods:[],displayName:"TilBehandlingPanel",props:{height:{required:!0,tsType:{name:"number"},description:""},valgtAvdelingEnhet:{required:!0,tsType:{name:"string"},description:""},getValueFromLocalStorage:{required:!0,tsType:{name:"signature",type:"function",raw:"(key: string) => string | undefined",signature:{arguments:[{type:{name:"string"},name:"key"}],return:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]}}},description:""}}};export{Q as T};
