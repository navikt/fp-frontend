import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{r as i}from"./index-Dxs5m6lS.js";import{L as _,M as d,e as E}from"./nb_NO-CDzvFqj3.js";import{s as A}from"./index.es-CuBg9eJB.js";import{u as D}from"./useQuery-DniJ7UPI.js";import{u as p}from"./useMutation-DD-4HaSg.js";import{K as F}from"./kodeverkTyper-BiqIm7FA.js";import{O as H,F as N}from"./FlyttReservasjonModal-DnhCmHrn.js";import{V as P,v as B,w as z,x as L,y as q,z as K}from"./fplosAvdelingslederApi-BSYAXExG.js";import{u as V}from"./useLosKodeverk-BQgSPvN3.js";import{T as r}from"./Table-CL1tGzGA.js";import{u as G,a as Q,S as X}from"./Modal-DvcqaT6j.js";var Y=function(n,c){var o={};for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&c.indexOf(a)<0&&(o[a]=n[a]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,a=Object.getOwnPropertySymbols(n);l<a.length;l++)c.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(n,a[l])&&(o[a[l]]=n[a[l]]);return o};const J=i.forwardRef((n,c)=>{var{title:o,titleId:a}=n,l=Y(n,["title","titleId"]);let t=G();return t=o?a||"title-"+t:void 0,i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",fill:"none",viewBox:"0 0 24 24",focusable:!1,role:"img",ref:c,"aria-labelledby":t},l),o?i.createElement("title",{id:t},o):null,i.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9 3.75a3.75 3.75 0 1 0 0 7.5 3.75 3.75 0 0 0 0-7.5M3.75 7.5a5.25 5.25 0 1 1 10.5 0 5.25 5.25 0 0 1-10.5 0M9 15.75A5.25 5.25 0 0 0 3.75 21a.75.75 0 0 1-1.5 0 6.75 6.75 0 0 1 13.5 0 .75.75 0 0 1-1.5 0A5.25 5.25 0 0 0 9 15.75m7.214-10.824a.75.75 0 1 0-.428 1.438A2.752 2.752 0 0 1 15 11.75a.75.75 0 0 0-.75.75v1a.75.75 0 0 0 .75.75 4.25 4.25 0 0 1 4.25 4.25.75.75 0 0 0 1.5 0 5.75 5.75 0 0 0-4.206-5.539 4.251 4.251 0 0 0-.33-8.035",clipRule:"evenodd"}))}),U="_removeIcon_1c1ll_1",W="_calendarIcon_1c1ll_7",Z="_flyttIcon_1c1ll_14",h={removeIcon:U,calendarIcon:W,flyttIcon:Z},$=({valgtAvdelingEnhet:n})=>{const[c,o]=i.useState(!1),[a,l]=i.useState(!1),[t,u]=i.useState(void 0),f=V(F.BEHANDLING_TYPE),{data:x,refetch:j}=D(K(n)),m=x.toSorted((s,v)=>s.reservertAvNavn.localeCompare(v.reservertAvNavn)),{mutate:R}=p({mutationFn:s=>B(s.oppgaveId),onSuccess:()=>j()}),{mutateAsync:y,data:b,status:g,reset:I}=p({mutationFn:s=>z(s.brukerIdent)}),w=s=>{o(!0),u(s)},S=s=>{l(!0),u(s)},{mutateAsync:T}=p({mutationFn:s=>L(s.oppgaveId,s.reserverTil)}),k=async s=>{if(!t)throw new Error("Reservasjon må være valgt");await T({oppgaveId:t.oppgaveId,reserverTil:s}),o(!1),j()},{mutateAsync:C}=p({mutationFn:s=>q(s.oppgaveId,s.brukerIdent,s.begrunnelse)}),O=async s=>{if(!t)throw new Error("Reservasjon må være valgt");await C({oppgaveId:t.oppgaveId,...s}),j()};return e.jsxs(P,{gap:"2",children:[e.jsx(_,{size:"small",children:e.jsx(d,{id:"ReservasjonerTabell.Reservasjoner"})}),m.length===0&&e.jsx(E,{size:"small",children:e.jsx(d,{id:"ReservasjonerTabell.IngenReservasjoner"})}),m.length>0&&e.jsxs(r,{children:[e.jsx(r.Header,{children:e.jsxs(r.Row,{children:[e.jsx(r.ColumnHeader,{children:e.jsx(d,{id:"ReservasjonerTabell.Navn"})}),e.jsx(r.ColumnHeader,{children:e.jsx(d,{id:"ReservasjonerTabell.Saksnr"})}),e.jsx(r.ColumnHeader,{children:e.jsx(d,{id:"ReservasjonerTabell.BehandlingType"})}),e.jsx(r.ColumnHeader,{children:e.jsx(d,{id:"ReservasjonerTabell.ReservertTil"})}),e.jsx(r.ColumnHeader,{children:e.jsx(d,{id:"ReservasjonerTabell.Endre"})}),e.jsx(r.ColumnHeader,{children:e.jsx(d,{id:"ReservasjonerTabell.Flytt"})}),e.jsx(r.ColumnHeader,{children:e.jsx(d,{id:"ReservasjonerTabell.Slett"})})]})}),e.jsx(r.Body,{children:m.map(s=>{var v;return e.jsxs(r.Row,{shadeOnHover:!1,children:[e.jsx(r.DataCell,{children:s.reservertAvNavn}),e.jsx(r.DataCell,{children:s.oppgaveSaksNr}),e.jsx(r.DataCell,{children:(v=f.find(M=>M.kode===s.behandlingType))==null?void 0:v.navn}),e.jsx(r.DataCell,{children:e.jsx(d,{id:"ReservasjonerTabell.ReservertTilFormat",values:A(s.reservertTilTidspunkt)})}),e.jsx(r.DataCell,{children:e.jsx(Q,{className:h.calendarIcon,onClick:()=>w(s)})}),e.jsx(r.DataCell,{children:e.jsx(J,{className:h.flyttIcon,onClick:()=>S(s)})}),e.jsx(r.DataCell,{children:e.jsx(X,{className:h.removeIcon,onClick:()=>R({oppgaveId:s.oppgaveId})})})]},s.oppgaveId)})})]}),t&&c&&e.jsx(H,{closeModal:()=>o(!1),reserverTilDefault:t.reservertTilTidspunkt,endreOppgavereservasjon:k}),t&&a&&e.jsx(N,{closeModal:()=>l(!1),flyttOppgavereservasjon:O,hentSaksbehandler:s=>y({brukerIdent:s}),hentSaksbehandlerIsPending:g==="pending",hentSaksbehandlerIsSuccess:g==="success",saksbehandler:b,resetHentSaksbehandler:I})]})};$.__docgenInfo={description:"",methods:[],displayName:"ReservasjonerTabell",props:{valgtAvdelingEnhet:{required:!0,tsType:{name:"string"},description:""}}};export{$ as R};
