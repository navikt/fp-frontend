{"version":3,"file":"GjeldendeSakslisterTabell-736ffccb.js","sources":["../../src/images/add-circle.svg","../../src/behandlingskoer/components/GjeldendeSakslisterTabell.tsx"],"sourcesContent":["export default \"__VITE_ASSET__49c85ac3__\"","import React, { useState, KeyboardEvent, FunctionComponent, useEffect, useRef, useCallback } from 'react';\nimport { FormattedMessage } from 'react-intl';\nimport { BodyShort, Detail, Label, Heading } from '@navikt/ds-react';\nimport { KodeverkMedNavn } from '@navikt/ft-types';\nimport {\n  Image,\n  VerticalSpacer,\n  Table,\n  TableRow,\n  TableColumn,\n  DateLabel,\n  FlexContainer,\n  FlexRow,\n  FlexColumn,\n} from '@navikt/ft-ui-komponenter';\nimport { KodeverkType } from '@navikt/ft-kodeverk';\n\nimport addCircleIcon from '../../images/add-circle.svg';\nimport removeIcon from '../../images/remove.svg';\nimport { restApiHooks, RestApiPathsKeys } from '../../data/fplosRestApi';\nimport useLosKodeverk from '../../data/useLosKodeverk';\nimport SletteSakslisteModal from './SletteSakslisteModal';\nimport Saksliste from '../../typer/sakslisteAvdelingTsType';\n\nimport styles from './gjeldendeSakslisterTabell.module.css';\n\nconst headerTextCodes = [\n  'GjeldendeSakslisterTabell.Listenavn',\n  'GjeldendeSakslisterTabell.Stonadstype',\n  'GjeldendeSakslisterTabell.Behandlingtype',\n  'GjeldendeSakslisterTabell.AntallSaksbehandlere',\n  'GjeldendeSakslisterTabell.AntallBehandlinger',\n  'GjeldendeSakslisterTabell.SistEndret',\n  'EMPTY_1',\n];\n\nconst formatStonadstyper = (fagsakYtelseTyper: KodeverkMedNavn[], valgteFagsakYtelseTyper?: string[]) => {\n  if (!valgteFagsakYtelseTyper || valgteFagsakYtelseTyper.length === 0) {\n    return <FormattedMessage id=\"GjeldendeSakslisterTabell.Alle\" />;\n  }\n\n  return valgteFagsakYtelseTyper\n    .map<string>(fyt => {\n      const type = fagsakYtelseTyper.find(def => def.kode === fyt);\n      return type ? type.navn : '';\n    })\n    .join(', ');\n};\n\nconst formatBehandlingstyper = (behandlingTyper: KodeverkMedNavn[], valgteBehandlingTyper?: string[]) => {\n  if (\n    !valgteBehandlingTyper ||\n    valgteBehandlingTyper.length === 0 ||\n    valgteBehandlingTyper.length === behandlingTyper.length\n  ) {\n    return <FormattedMessage id=\"GjeldendeSakslisterTabell.Alle\" />;\n  }\n\n  return valgteBehandlingTyper\n    .map<string>(bt => {\n      const type = behandlingTyper.find(def => def.kode === bt);\n      return type ? type.navn : '';\n    })\n    .join(', ');\n};\n\ninterface OwnProps {\n  sakslister: Saksliste[];\n  setValgtSakslisteId: (sakslisteId: number) => void;\n  valgtSakslisteId?: number;\n  valgtAvdelingEnhet: string;\n  oppgaverForAvdelingAntall?: number;\n  lagNySaksliste: (avdelingEnhet: string) => void;\n  resetValgtSakslisteId: () => void;\n  hentAvdelingensSakslister: (params: { avdelingEnhet: string }) => void;\n}\n\nconst wait = (ms: number): Promise<any> =>\n  new Promise(resolve => {\n    setTimeout(resolve, ms);\n  });\n\n/**\n * GjeldendeSakslisterTabell\n */\nexport const GjeldendeSakslisterTabell: FunctionComponent<OwnProps> = ({\n  sakslister,\n  valgtAvdelingEnhet,\n  setValgtSakslisteId,\n  valgtSakslisteId,\n  oppgaverForAvdelingAntall,\n  lagNySaksliste,\n  resetValgtSakslisteId,\n  hentAvdelingensSakslister,\n}) => {\n  const [valgtSaksliste, setValgtSakslisteTemp] = useState<Saksliste>();\n  const tabRef = useRef<(HTMLDivElement | null)[]>([]);\n\n  const behandlingTyper = useLosKodeverk(KodeverkType.BEHANDLING_TYPE);\n  const fagsakYtelseTyper = useLosKodeverk(KodeverkType.FAGSAK_YTELSE);\n\n  const { startRequest: fjernSaksliste } = restApiHooks.useRestApiRunner(RestApiPathsKeys.SLETT_SAKSLISTE);\n\n  useEffect(() => {\n    tabRef.current = tabRef.current.slice(0, sakslister.length);\n  }, [sakslister]);\n\n  const setValgtSaksliste = async (\n    event: React.MouseEvent | React.KeyboardEvent,\n    id?: number,\n  ): Promise<string | undefined> => {\n    // @ts-ignore Fiks\n    if (tabRef.current.some(node => node && node.contains(event.target))) {\n      return;\n    }\n\n    // Må vente 100 ms før en byttar behandlingskø i tabell. Dette fordi lagring av navn skjer som blur-event. Så i tilfellet\n    // der en endrer navn og så trykker direkte på en annen behandlingskø vil ikke lagringen skje før etter at ny kø er valgt.\n    await wait(100);\n\n    if (id) {\n      setValgtSakslisteId(id);\n    }\n  };\n\n  const lagNySakslisteFn = useCallback(\n    (event: KeyboardEvent): void => {\n      if (event.keyCode === 13) {\n        lagNySaksliste(valgtAvdelingEnhet);\n      }\n    },\n    [valgtAvdelingEnhet],\n  );\n\n  const visFjernSakslisteModal = (nyValgtSaksliste: Saksliste): void => {\n    setValgtSakslisteTemp(nyValgtSaksliste);\n  };\n\n  const closeSletteModal = useCallback((): void => {\n    setValgtSakslisteTemp(undefined);\n  }, []);\n\n  const fjernSakslisteFn = useCallback(\n    (saksliste: Saksliste): void => {\n      closeSletteModal();\n      fjernSaksliste({ sakslisteId: saksliste.sakslisteId, avdelingEnhet: valgtAvdelingEnhet }).then(() => {\n        resetValgtSakslisteId();\n        hentAvdelingensSakslister({ avdelingEnhet: valgtAvdelingEnhet });\n      });\n    },\n    [valgtAvdelingEnhet],\n  );\n\n  return (\n    <>\n      <FlexContainer>\n        <FlexRow>\n          <FlexColumn>\n            <Label size=\"small\">\n              <FormattedMessage id=\"GjeldendeSakslisterTabell.GjeldendeLister\" />\n            </Label>\n          </FlexColumn>\n          <FlexColumn className={styles.margin}>\n            <div className={styles.grayBox}>\n              <BodyShort size=\"small\">\n                <FormattedMessage id=\"GjeldendeSakslisterTabell.OppgaverForAvdeling\" />\n              </BodyShort>\n              <Heading size=\"small\">{oppgaverForAvdelingAntall || '0'}</Heading>\n            </div>\n          </FlexColumn>\n        </FlexRow>\n      </FlexContainer>\n      {sakslister.length === 0 && (\n        <>\n          <VerticalSpacer eightPx />\n          <BodyShort size=\"small\">\n            <FormattedMessage id=\"GjeldendeSakslisterTabell.IngenLister\" />\n          </BodyShort>\n          <VerticalSpacer eightPx />\n        </>\n      )}\n      {sakslister.length > 0 && (\n        <Table headerTextCodes={headerTextCodes}>\n          {sakslister.map((saksliste, index) => (\n            <TableRow\n              key={saksliste.sakslisteId}\n              className={saksliste.sakslisteId === valgtSakslisteId ? styles.isSelected : undefined}\n              id={saksliste.sakslisteId}\n              onMouseDown={setValgtSaksliste}\n              onKeyDown={setValgtSaksliste}\n            >\n              <TableColumn>{saksliste.navn}</TableColumn>\n              <TableColumn>{formatStonadstyper(fagsakYtelseTyper, saksliste.fagsakYtelseTyper)}</TableColumn>\n              <TableColumn>{formatBehandlingstyper(behandlingTyper, saksliste.behandlingTyper)}</TableColumn>\n              <TableColumn>\n                {saksliste.saksbehandlerIdenter.length > 0 ? saksliste.saksbehandlerIdenter.length : ''}\n              </TableColumn>\n              <TableColumn>{saksliste.antallBehandlinger}</TableColumn>\n              <TableColumn>\n                <DateLabel dateString={saksliste.sistEndret} />\n              </TableColumn>\n              <TableColumn>\n                <div\n                  ref={el => {\n                    tabRef.current[index] = el;\n                  }}\n                >\n                  <Image\n                    src={removeIcon}\n                    className={styles.removeImage}\n                    onMouseDown={() => visFjernSakslisteModal(saksliste)}\n                    onKeyDown={() => visFjernSakslisteModal(saksliste)}\n                  />\n                </div>\n              </TableColumn>\n            </TableRow>\n          ))}\n        </Table>\n      )}\n      <div\n        id=\"leggTilListe\"\n        role=\"button\"\n        tabIndex={0}\n        className={styles.addPeriode}\n        onClick={() => lagNySaksliste(valgtAvdelingEnhet)}\n        onKeyDown={lagNySakslisteFn}\n      >\n        <Image className={styles.addCircleIcon} src={addCircleIcon} />\n        <Detail size=\"small\" className={styles.imageText}>\n          <FormattedMessage id=\"GjeldendeSakslisterTabell.LeggTilListe\" />\n        </Detail>\n      </div>\n      {valgtSaksliste && (\n        <SletteSakslisteModal valgtSaksliste={valgtSaksliste} cancel={closeSletteModal} submit={fjernSakslisteFn} />\n      )}\n    </>\n  );\n};\n\nexport default GjeldendeSakslisterTabell;\n"],"names":["addCircleIcon$1","headerTextCodes","formatStonadstyper","fagsakYtelseTyper","valgteFagsakYtelseTyper","jsx","FormattedMessage","fyt","type","def","formatBehandlingstyper","behandlingTyper","valgteBehandlingTyper","bt","wait","ms","resolve","GjeldendeSakslisterTabell","sakslister","valgtAvdelingEnhet","setValgtSakslisteId","valgtSakslisteId","oppgaverForAvdelingAntall","lagNySaksliste","resetValgtSakslisteId","hentAvdelingensSakslister","valgtSaksliste","setValgtSakslisteTemp","useState","tabRef","useRef","useLosKodeverk","KodeverkType","fjernSaksliste","restApiHooks","RestApiPathsKeys","useEffect","setValgtSaksliste","event","id","node","lagNySakslisteFn","useCallback","visFjernSakslisteModal","nyValgtSaksliste","closeSletteModal","fjernSakslisteFn","saksliste","jsxs","Fragment","FlexContainer","FlexRow","FlexColumn","Label","styles","BodyShort","Heading","VerticalSpacer","Table","index","TableRow","TableColumn","DateLabel","el","Image","removeIcon","addCircleIcon","Detail","SletteSakslisteModal"],"mappings":"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"}