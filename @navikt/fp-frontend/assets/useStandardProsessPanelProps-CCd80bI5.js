import{r as m,j as P,bo as D,bB as b,bC as R}from"./iframe-vns38nQ9.js";import{B as f}from"./FagsakIndex-CTdUN742.js";import{B as F,P as S}from"./BehandlingHenlagtPanel-B_32wLh5.js";import{k as I,M as T}from"./index.es-DGwJMw-j.js";import{e as M}from"./aksjonspunktUtils-Bp6ewLMR.js";const L=()=>{const[e,r]=m.useState([]),n=s=>{r(i=>{const t=[...i],a=t.findIndex(o=>o.id===s.id);return a>=0?t.splice(a,1,s):t.push(s),t})};return{prosessPanelMenyData:e.filter(s=>s.skalVisesIMeny),settProsessPanelMenyData:n}},x="_container_142tr_1",C="_meny_142tr_9",q="_stepArrowContainer_142tr_16",v={container:x,meny:C,stepArrowContainer:q},U=({valgtProsessSteg:e,valgtFaktaSteg:r,children:n})=>{const{oppdaterProsessStegOgFaktaPanelIUrl:s}=m.use(f),{behandling:i}=m.use(f),{prosessPanelMenyData:t,settProsessPanelMenyData:a}=L(),o=d=>{const c=t[d],k=c?.erAktiv?void 0:c?.id;s(k,r)},l=t.map(d=>{const c=V(d.status,d.harÅpentAksjonspunkt);return{label:d.tekst,isActive:d.erAktiv,type:c}});return P.jsxs("div",{className:v.container,children:[P.jsx("div",{className:v.meny,"data-testid":"prosess-meny",children:P.jsx(I,{steps:l,onClick:o,stepArrowContainerStyle:v.stepArrowContainer})}),P.jsx(B,{valgtProsessSteg:e,settProsessPanelMenyData:a,prosessPanelMenyData:t,children:n}),i.behandlingHenlagt&&P.jsx(F,{valgtProsessSteg:e,settProsessPanelMenyData:a})]})},j=m.createContext({}),B=e=>{const{children:r,...n}=e,s=m.useMemo(()=>n,[n]);return P.jsx(j.Provider,{value:s,children:r})},V=(e,r)=>r?T.warning:e==="OPPFYLT"?T.success:e==="IKKE_OPPFYLT"?T.danger:T.default;U.__docgenInfo={description:"",methods:[],displayName:"ProsessMeny",props:{valgtProsessSteg:{required:!0,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},valgtFaktaSteg:{required:!0,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},children:{required:!0,tsType:{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"},description:""}}};const w=(e,r)=>e!=="UTRED"?{}:r.reduce((n,s)=>({...n,[s.definisjon]:{notAccepted:s.toTrinnsBehandling&&s.toTrinnsBehandlingGodkjent===!1}}),{}),Y=e=>e.taskStatus?.readOnly??!1,N=(e,r,n,s)=>{const{behandlingPåVent:i}=e,t=s||Y(e),a=r.some(o=>!o.overstyrbar);return!n.writeAccess.isEnabled||i||t||a},G="default",H=(e,r,n,s,i,t)=>{const{valgtProsessSteg:a,settProsessPanelMenyData:o}=m.use(j),l=n&&(a===e||t&&a===G);return m.useEffect(()=>{o({id:e,tekst:r,erAktiv:l,harÅpentAksjonspunkt:s,status:i,skalVisesIMeny:n})},[n,l,s,i]),n&&l},W=e=>P.jsx(A,{...e,harÅpentAksjonspunkt:e.standardPanelProps.harÅpentAksjonspunkt}),z=e=>{const{erOverstyrt:r}=D(),n=r||e.standardPanelProps.harÅpentAksjonspunkt;return P.jsx(A,{...e,harÅpentAksjonspunkt:n})},A=({overstyrtStatus:e,skalMarkeresSomAktiv:r,skalPanelVisesIMeny:n,prosessPanelKode:s,prosessPanelMenyTekst:i,standardPanelProps:t,harÅpentAksjonspunkt:a,children:o})=>{const{behandling:l,fagsak:d,alleKodeverk:c}=m.use(f),k=e??t.status,p=!!r&&!l.behandlingHenlagt,u=H(s,i,n,a,k,p||a),g=u&&(a||k!=="IKKE_VURDERT");return P.jsx(b,{behandling:l,children:P.jsx(S,{erPanelValgt:u,harÅpentAksjonspunkt:t.harÅpentAksjonspunkt,status:k,children:g?P.jsx(R,{behandling:l,fagsak:d,aksjonspunkterForPanel:t.aksjonspunkterForPanel,harÅpentAksjonspunkt:t.harÅpentAksjonspunkt,alleKodeverk:c,submitCallback:t.submitCallback,isReadOnly:t.isReadOnly,alleMerknaderFraBeslutter:t.alleMerknaderFraBeslutter,isSubmittable:!t.readOnlySubmitButton,children:o}):null})})};W.__docgenInfo={description:"",methods:[],displayName:"ProsessDefaultInitPanel",props:{skalPanelVisesIMeny:{required:!0,tsType:{name:"boolean"},description:""},overstyrtStatus:{required:!1,tsType:{name:"union",raw:`| 'OPPFYLT'
| 'IKKE_OPPFYLT'
| 'IKKE_VURDERT'
| '-'`,elements:[{name:"literal",value:"'OPPFYLT'"},{name:"literal",value:"'IKKE_OPPFYLT'"},{name:"literal",value:"'IKKE_VURDERT'"},{name:"literal",value:"'-'"}]},description:""},prosessPanelKode:{required:!0,tsType:{name:"ProsessStegCode"},description:""},prosessPanelMenyTekst:{required:!0,tsType:{name:"string"},description:""},skalMarkeresSomAktiv:{required:!1,tsType:{name:"boolean"},description:""},standardPanelProps:{required:!0,tsType:{name:"StandardProsessPanelProps"},description:""},children:{required:!0,tsType:{name:"ReactElement"},description:""}}};z.__docgenInfo={description:"",methods:[],displayName:"ProsessDefaultInitOverstyringPanel",props:{skalPanelVisesIMeny:{required:!0,tsType:{name:"boolean"},description:""},overstyrtStatus:{required:!1,tsType:{name:"union",raw:`| 'OPPFYLT'
| 'IKKE_OPPFYLT'
| 'IKKE_VURDERT'
| '-'`,elements:[{name:"literal",value:"'OPPFYLT'"},{name:"literal",value:"'IKKE_OPPFYLT'"},{name:"literal",value:"'IKKE_VURDERT'"},{name:"literal",value:"'-'"}]},description:""},prosessPanelKode:{required:!0,tsType:{name:"ProsessStegCode"},description:""},prosessPanelMenyTekst:{required:!0,tsType:{name:"string"},description:""},skalMarkeresSomAktiv:{required:!1,tsType:{name:"boolean"},description:""},standardPanelProps:{required:!0,tsType:{name:"StandardProsessPanelProps"},description:""},children:{required:!0,tsType:{name:"ReactElement"},description:""}}};const J="default",Q="default",ae=(e=[],r=[],n)=>{const{behandling:s,rettigheter:i,fagsak:t,lagreAksjonspunkter:a,lagreOverstyrteAksjonspunkter:o,alleKodeverk:l,oppdaterProsessStegOgFaktaPanelIUrl:d}=m.use(f),{aksjonspunkt:c,vilkår:k}=s,p=c.filter(y=>e.includes(y.definisjon)),u=(k??[]).filter(y=>r.includes(y.vilkarType)),g=N(s,u,i,!1),O=w(s.status,p),h=p.some(y=>y.status==="OPPR"&&y.kanLoses),E=Z(u,p),_=!p.some(y=>y.kanLoses)||E==="OPPFYLT",K=X(n||(()=>()=>{d(Q,J),globalThis.scrollTo({top:0,behavior:"smooth"})}),t,s,p,a,o);return{fagsak:t,behandling:s,harÅpentAksjonspunkt:h,isAksjonspunktOpen:h,aksjonspunkter:p,aksjonspunkterForPanel:p,vilkårForPanel:u,alleKodeverk:l,alleMerknaderFraBeslutter:O,isReadOnly:g,readOnlySubmitButton:_,submitCallback:K,status:E}},X=(e,r,n,s,i,t)=>a=>{const o=Array.isArray(a)?a:[a],l=o.map(u=>({"@type":u.kode,...u})),d={saksnummer:r.saksnummer,behandlingUuid:n.uuid,behandlingVersjon:n.versjon},c=e(o),k=s.filter(u=>o.some(g=>g.kode===u.definisjon)),p=k.some(u=>u.aksjonspunktType==="OVST"||u.aksjonspunktType==="SAOV");if(o.length===0)throw new Error("Det har oppstått en teknisk feil ved lagring av aksjonspunkter. Meld feilen i Porten.");return k.length===0||p?t({...d,overstyrteAksjonspunktDtoer:l}).then(c):i({...d,bekreftedeAksjonspunktDtoer:l}).then(c)},Z=(e,r)=>{if(e.length>0){const n=e.map(s=>s.vilkarStatus);return n.includes("IKKE_VURDERT")?"IKKE_VURDERT":n.every(s=>s==="OPPFYLT")?"OPPFYLT":"IKKE_OPPFYLT"}return r.length>0?r.some(M)?"IKKE_VURDERT":"OPPFYLT":"IKKE_VURDERT"};export{W as P,U as a,z as b,j as c,H as d,N as e,w as g,ae as u};
