import{j as O}from"./jsx-runtime-CLpGMVip.js";import{r as T}from"./index-B5OHeJSP.js";import"./aktivitetStatus-02fOJoqz.js";import{V as k,P as j}from"./BehandlingHenlagtPanel-Dy1MJY7R.js";import{O as b}from"./FormDataContext-B1rdxO_J.js";import{B as S}from"./behandlingDataContext-BMbp9e-c.js";import{b as D}from"./index.es-BEBRLXnK.js";import{A as K,i as L}from"./aksjonspunktStatus-xM4O_ZUY.js";import{B as V}from"./behandlingStatus-CZkrUkra.js";var A=(t=>(t.MANUELL="MANU",t.AUTOPUNKT="AUTO",t.OVERSTYRING="OVST",t.SAKSBEHANDLEROVERSTYRING="SAOV",t))(A||{});const U=(t,s)=>t.status!==V.BEHANDLING_UTREDES?{}:s.reduce((n,e)=>({...n,[e.definisjon]:{notAccepted:e.toTrinnsBehandling&&e.toTrinnsBehandlingGodkjent===!1}}),{}),_=t=>{var s;return((s=t.taskStatus)==null?void 0:s.readOnly)??!1},q=(t,s,n,e)=>{const{behandlingPaaVent:d}=t,i=e||_(t),u=s.some(a=>!a.overstyrbar);return!n.writeAccess.isEnabled||d||i||u},B="default",F=(t,s,n,e,d,i,u,a)=>{const[p,f]=T.useState(!1);T.useEffect(()=>{t({id:s})},[]);const o=e&&(a===s||u&&a===B),r=D(e);return T.useEffect(()=>{e?t({id:s,tekst:n,erAktiv:o,harApentAksjonspunkt:d,status:i}):!e&&r&&t({id:s}),f(o)},[e,r,o,d,i]),e&&p},N=({valgtProsessSteg:t,registrerProsessPanel:s,skalPanelVisesIMeny:n,prosessPanelKode:e,prosessPanelMenyTekst:d,hentOverstyrtStatus:i,erOverstyrt:u=!1,hentSkalMarkeresSomAktiv:a,standardPanelProps:p,children:f})=>{const o=i??p.status,{behandling:r}=T.use(S),c=a&&!r.behandlingHenlagt,l=u||p.isAksjonspunktOpen,g=F(s,e,d,n,l,o,c||l,t),E=g&&(l||o!==k.IKKE_VURDERT);return O.jsx(b,{behandling:r,children:O.jsx(j,{erPanelValgt:g,erAksjonspunktOpent:p.isAksjonspunktOpen,status:o,children:E?f:null})})};N.__docgenInfo={description:"",methods:[],displayName:"ProsessDefaultInitPanel",props:{skalPanelVisesIMeny:{required:!0,tsType:{name:"boolean"},description:""},hentOverstyrtStatus:{required:!1,tsType:{name:"string"},description:""},prosessPanelKode:{required:!0,tsType:{name:"ProsessStegCode"},description:""},prosessPanelMenyTekst:{required:!0,tsType:{name:"string"},description:""},erOverstyrt:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},hentSkalMarkeresSomAktiv:{required:!1,tsType:{name:"boolean"},description:""},standardPanelProps:{required:!0,tsType:{name:"StandardProsessPanelProps"},description:""},children:{required:!0,tsType:{name:"ReactElement"},description:""},valgtProsessSteg:{required:!1,tsType:{name:"string"},description:""},registrerProsessPanel:{required:!0,tsType:{name:"signature",type:"function",raw:"(data: ProsessPanelMenyData) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  id: string;
  tekst?: string;
  erAktiv?: boolean;
  harApentAksjonspunkt?: boolean;
  status?: string;
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"tekst",value:{name:"string",required:!1}},{key:"erAktiv",value:{name:"boolean",required:!1}},{key:"harApentAksjonspunkt",value:{name:"boolean",required:!1}},{key:"status",value:{name:"string",required:!1}}]}},name:"data"}],return:{name:"void"}}},description:""}}};const I="default",M="default",Y=(t,s,n,e,d,i)=>u=>{const a=Array.isArray(u)?u:[u],p=a.map(r=>({"@type":r.kode,...r})),f={saksnummer:s.saksnummer,behandlingUuid:n.uuid,behandlingVersjon:n.versjon},o=t(a);if(i){const r=e.filter(l=>a.some(g=>g.kode===l.definisjon)),c=r.some(l=>l.aksjonspunktType===A.OVERSTYRING||l.aksjonspunktType===A.SAKSBEHANDLEROVERSTYRING);if(a.length===0)throw Error("Det har oppstått en teknisk feil ved lagring av aksjonspunkter. Meld feilen i Porten.");if(r.length===0||c)return i({...f,overstyrteAksjonspunktDtoer:p}).then(o)}return d({...f,bekreftedeAksjonspunktDtoer:p}).then(o)},G=(t,s)=>{if(t.length>0){const n=t.map(e=>e.vilkarStatus);return n.some(e=>e===k.IKKE_VURDERT)?k.IKKE_VURDERT:n.every(e=>e===k.OPPFYLT)?k.OPPFYLT:k.IKKE_OPPFYLT}return s.length>0?s.some(n=>L(n.status))?k.IKKE_VURDERT:k.OPPFYLT:k.IKKE_VURDERT},$=(t,s,n)=>{const{behandling:e,rettigheter:d,fagsak:i,lagreAksjonspunkter:u,lagreOverstyrteAksjonspunkter:a,alleKodeverk:p,oppdaterProsessStegOgFaktaPanelIUrl:f}=T.use(S),{aksjonspunkt:o,vilkår:r}=e,c=o&&t?o.filter(m=>t.some(P=>P===m.definisjon)):[],l=r&&s?r.filter(m=>s.some(P=>P===m.vilkarType)):[],g=q(e,l,d,!1),E=U(e,c),h=c.some(m=>m.status===K.OPPRETTET&&m.kanLoses),y=G(l,c),v=!c.some(m=>m.kanLoses)||k.OPPFYLT===y,R=Y(n||(()=>()=>{f(M,I)}),i,e,c,u,a);return{fagsak:i,behandling:e,isAksjonspunktOpen:h,aksjonspunkter:c,vilkar:l,alleKodeverk:p,alleMerknaderFraBeslutter:E,isReadOnly:g,readOnlySubmitButton:v,submitCallback:R,status:y}};export{N as P,F as a,q as e,U as g,$ as u};
