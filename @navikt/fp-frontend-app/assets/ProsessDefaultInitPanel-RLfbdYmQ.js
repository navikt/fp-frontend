import{j as K}from"./index.es-bAYtWfR3.js";import{R as j}from"./useGlobalStateRestApiData-r44WP_jM.js";import{S as D,R as V,r as b}from"./AppIndex.stories-hqElHSC3.js";import{r as d}from"./index-DogsOklH.js";import{b as L,H as F,x as m,E as M}from"./index.es-tCBKjOwM.js";import{K as U}from"./index.es-RGXi7VaD.js";import{P as I}from"./BehandlingHenlagtPanel-520iYYuc.js";const _={MANUELL:"MANU",AUTOPUNKT:"AUTO",OVERSTYRING:"OVST",SAKSBEHANDLEROVERSTYRING:"SAOV"},N={OPPFYLT:"OPPFYLT",IKKE_OPPFYLT:"IKKE_OPPFYLT",IKKE_VURDERT:"IKKE_VURDERT"},q=a=>a.taskStatus&&a.taskStatus.readOnly?a.taskStatus.readOnly:!1,B=(a,t,r,e,p)=>{const{behandlingPaaVent:n}=a,o=p||q(a),l=r.some(s=>!s.overstyrbar);return!e.writeAccess.isEnabled||n||o||l},Y=(a,t)=>a.status!==L.BEHANDLING_UTREDES?{}:t.reduce((r,e)=>({...r,[e.definisjon]:{notAccepted:e.toTrinnsBehandling&&e.toTrinnsBehandlingGodkjent===!1}}),{}),C="default",x="default",G=(a,t,r,e,p,n)=>o=>{const l=Array.isArray(o)?o:[o],s=l.map(u=>({"@type":u.kode,...u})),k={saksnummer:t.saksnummer,behandlingUuid:r.uuid,behandlingVersjon:r.versjon},f=a(l);if(n){const u=e.filter(g=>l.some(c=>c.kode===g.definisjon)),v=u.some(g=>g.aksjonspunktType===_.OVERSTYRING||g.aksjonspunktType===_.SAKSBEHANDLEROVERSTYRING);if(l.length===0)throw Error("Det har oppstått en teknisk feil ved lagring av aksjonspunkter. Meld feilen i Porten.");if(u.length===0||v)return n({...k,overstyrteAksjonspunktDtoer:s},!0).then(f)}return p({...k,bekreftedeAksjonspunktDtoer:s},!0).then(f)},H=(a,t)=>{if(a.length>0){const r=a.map(e=>e.vilkarStatus);return r.some(e=>e===m.IKKE_VURDERT)?m.IKKE_VURDERT:r.every(e=>e===m.OPPFYLT)?m.OPPFYLT:m.IKKE_OPPFYLT}return t.length>0?t.some(r=>M(r.status))?m.IKKE_VURDERT:m.OPPFYLT:m.IKKE_VURDERT},w=(a,t,r)=>{const[e,p]=d.useState(),n=d.useContext(D),{aksjonspunkt:o,vilkår:l}=n.behandling;d.useEffect(()=>{e&&p(void 0)},[n.behandling.versjon]);const s=d.useMemo(()=>o&&a?o.filter(i=>a.includes(i.definisjon)):[],[o,a]),k=d.useMemo(()=>l&&t?l.filter(i=>t.includes(i.vilkarType)):[],[l,t]),f=B(n.behandling,s,k,n.rettigheter,n.hasFetchError),u=d.useMemo(()=>Y(n.behandling,s),[n.behandling.versjon,s]),v=s.some(i=>i.status===F.OPPRETTET&&i.kanLoses),g=d.useMemo(()=>H(k,s),[k,s]),c=!s.some(i=>i.kanLoses)||m.OPPFYLT===g,P=d.useCallback(()=>()=>{n.oppdaterProsessStegOgFaktaPanelIUrl(x,C)},[]),E=d.useMemo(()=>G(r||P,n.fagsak,n.behandling,s,n.lagreAksjonspunkter,n.lagreOverstyrteAksjonspunkter),[n.behandling.versjon,s]);return{behandling:n.behandling,isAksjonspunktOpen:v,aksjonspunkter:s,vilkar:k,alleKodeverk:n.alleKodeverk,alleMerknaderFraBeslutter:u,isReadOnly:f,readOnlySubmitButton:c,submitCallback:E,status:g,formData:e,setFormData:p}},J="default",W=(a,t,r,e,p,n,o,l)=>{const[s,k]=d.useState(!1);d.useEffect(()=>{a({id:t})},[]);const f=e&&(l===t||o&&l===J),u=U(e);return d.useEffect(()=>{e?a({id:t,tekst:r,erAktiv:f,harApentAksjonspunkt:p,status:n}):!e&&u&&a({id:t}),k(f)},[e,u,f,p,n]),e&&s},R=({valgtProsessSteg:a,behandling:t,registrerProsessPanel:r,panelEndepunkter:e=[],aksjonspunktKoder:p,vilkarKoder:n,skalPanelVisesIMeny:o,renderPanel:l,prosessPanelKode:s,prosessPanelMenyTekst:k,lagringSideEffekter:f,hentOverstyrtStatus:u,erOverstyrt:v=!1,hentSkalMarkeresSomAktiv:g})=>{const c=w(p,n,f),P=u?u(c):c.status,E=g&&g(c)&&!t.behandlingHenlagt,i=v||c.isAksjonspunktOpen,y=W(r,s,k,o(c),i,P,E||i,a),S=e.map(T=>T instanceof V?{key:T}:T),A=!y||S.length===0||P===N.IKKE_VURDERT&&!i,{data:h,state:O}=b.useMultipleRestApi(S,{updateTriggers:[y,t.versjon,P,i],suspendRequest:A,isCachingOn:!0});return K.jsx(I,{erPanelValgt:y,erAksjonspunktOpent:c.isAksjonspunktOpen,status:P,dataState:S.length>0?O:j.SUCCESS,children:l({...h,...c})})};try{R.displayName="ProsessDefaultInitPanel",R.__docgenInfo={description:"",displayName:"ProsessDefaultInitPanel",props:{panelEndepunkter:{defaultValue:{value:"[]"},description:"",name:"panelEndepunkter",required:!1,type:{name:"RestKey<any, any>[] | { key: RestKey<any, any>; params?: any; }[]"}},aksjonspunktKoder:{defaultValue:null,description:"",name:"aksjonspunktKoder",required:!1,type:{name:"string[]"}},vilkarKoder:{defaultValue:null,description:"",name:"vilkarKoder",required:!1,type:{name:"string[]"}},skalPanelVisesIMeny:{defaultValue:null,description:"",name:"skalPanelVisesIMeny",required:!0,type:{name:"(data: StandardProsessPanelProps) => boolean"}},hentOverstyrtStatus:{defaultValue:null,description:"",name:"hentOverstyrtStatus",required:!1,type:{name:"((standardData: StandardProsessPanelProps) => string)"}},renderPanel:{defaultValue:null,description:"",name:"renderPanel",required:!0,type:{name:"(data: PANEL_DATA & StandardProsessPanelProps) => ReactElement<any, string | JSXElementConstructor<any>>"}},prosessPanelKode:{defaultValue:null,description:"",name:"prosessPanelKode",required:!0,type:{name:"enum",value:[{value:'"default"'},{value:'"inngangsvilkar"'},{value:'"behandle_innsyn"'},{value:'"beregning"'},{value:'"beregningsgrunnlag"'},{value:'"klage_nav_familie_og_pensjon"'},{value:'"klage_nav_klageinstans"'},{value:'"formkrav_klage_nav_klageinstans"'},{value:'"formkrav_klage_nav_familie_og_pensjon"'},{value:'"fortsattmedlemskap"'},{value:'"opplysningsplikt"'},{value:'"soeknadsfrist"'},{value:'"tilbakekreving"'},{value:'"foreldelse"'},{value:'"tilkjent_ytelse"'},{value:'"varsel"'},{value:'"vedtak"'},{value:'"uttak"'},{value:'"simulering"'},{value:'"resultat"'},{value:'"ankebehandling"'},{value:'"ankemerknader"'},{value:'"ankeresultat"'}]}},prosessPanelMenyTekst:{defaultValue:null,description:"",name:"prosessPanelMenyTekst",required:!0,type:{name:"string"}},lagringSideEffekter:{defaultValue:null,description:"",name:"lagringSideEffekter",required:!1,type:{name:"((aksjonspunktModeller: any) => () => void)"}},erOverstyrt:{defaultValue:{value:"false"},description:"",name:"erOverstyrt",required:!1,type:{name:"boolean"}},hentSkalMarkeresSomAktiv:{defaultValue:null,description:"",name:"hentSkalMarkeresSomAktiv",required:!1,type:{name:"((standardData: StandardProsessPanelProps) => boolean)"}},behandling:{defaultValue:null,description:"",name:"behandling",required:!0,type:{name:"Behandling"}},valgtProsessSteg:{defaultValue:null,description:"",name:"valgtProsessSteg",required:!1,type:{name:"string"}},registrerProsessPanel:{defaultValue:null,description:"",name:"registrerProsessPanel",required:!0,type:{name:"(data: ProsessPanelMenyData) => void"}}}}}catch{}export{R as P,W as a,B as e,Y as g,w as u,N as v};
