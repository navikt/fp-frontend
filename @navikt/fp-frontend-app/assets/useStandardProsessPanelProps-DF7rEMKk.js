import{j as y}from"./jsx-runtime-CLpGMVip.js";import{r as P}from"./index-B5OHeJSP.js";import{B as R,X as q,Y as D,Z as K}from"./withPanelData-BD6kgoz0.js";import{V as c,P as F}from"./BehandlingHenlagtPanel-DP91amuS.js";import{B as E}from"./behandlingDataContext-BMbp9e-c.js";import{b as L}from"./index.es-BJ5ePes3.js";import{A as M,i as V}from"./aksjonspunktStatus-xM4O_ZUY.js";var A=(e=>(e.MANUELL="MANU",e.AUTOPUNKT="AUTO",e.OVERSTYRING="OVST",e.SAKSBEHANDLEROVERSTYRING="SAOV",e))(A||{});const _=(e,t)=>e.status!==R.BEHANDLING_UTREDES?{}:t.reduce((n,s)=>({...n,[s.definisjon]:{notAccepted:s.toTrinnsBehandling&&s.toTrinnsBehandlingGodkjent===!1}}),{}),B=e=>{var t;return((t=e.taskStatus)==null?void 0:t.readOnly)??!1},U=(e,t,n,s)=>{const{behandlingPaaVent:d}=e,i=s||B(e),l=t.some(r=>!r.overstyrbar);return!n.writeAccess.isEnabled||d||i||l},I="default",N=(e,t,n,s,d,i,l,r)=>{const[k,g]=P.useState(!1);P.useEffect(()=>{e({id:t})},[]);const o=s&&(r===t||l&&r===I),a=L(s);return P.useEffect(()=>{s?e({id:t,tekst:n,erAktiv:o,harApentAksjonspunkt:d,status:i}):!s&&a&&e({id:t}),g(o)},[s,a,o,d,i]),s&&k},x=e=>{const{standardPanelProps:t}=e,n=t.isAksjonspunktOpen;return y.jsx(O,{...e,harApentAksjonspunkt:n})},Y=e=>{const{erOverstyrt:t}=q(),{standardPanelProps:n}=e,s=t||n.isAksjonspunktOpen;return y.jsx(O,{...e,harApentAksjonspunkt:s})},O=({valgtProsessSteg:e,hentOverstyrtStatus:t,registrerProsessPanel:n,hentSkalMarkeresSomAktiv:s,skalPanelVisesIMeny:d,prosessPanelKode:i,prosessPanelMenyTekst:l,standardPanelProps:r,harApentAksjonspunkt:k,children:g})=>{const{behandling:o}=P.use(E),a=t??r.status,p=!!s&&!o.behandlingHenlagt,u=N(n,i,l,d,k,a,p||k,e),f=u&&(k||a!==c.IKKE_VURDERT);return y.jsx(D,{behandling:o,children:y.jsx(F,{erPanelValgt:u,erAksjonspunktOpent:r.isAksjonspunktOpen,status:a,children:f?y.jsx(K,{behandling:o,fagsak:r.fagsak,aksjonspunkterForPanel:r.aksjonspunkter,harÅpneAksjonspunkter:r.isAksjonspunktOpen,alleKodeverk:r.alleKodeverk,submitCallback:r.submitCallback,isReadOnly:r.isReadOnly,alleMerknaderFraBeslutter:r.alleMerknaderFraBeslutter,children:g}):null})})};x.__docgenInfo={description:"",methods:[],displayName:"ProsessDefaultInitPanel",props:{skalPanelVisesIMeny:{required:!0,tsType:{name:"boolean"},description:""},hentOverstyrtStatus:{required:!1,tsType:{name:"string"},description:""},prosessPanelKode:{required:!0,tsType:{name:"ProsessStegCode"},description:""},prosessPanelMenyTekst:{required:!0,tsType:{name:"string"},description:""},hentSkalMarkeresSomAktiv:{required:!1,tsType:{name:"boolean"},description:""},standardPanelProps:{required:!0,tsType:{name:"StandardProsessPanelProps"},description:""},children:{required:!0,tsType:{name:"ReactElement"},description:""},valgtProsessSteg:{required:!1,tsType:{name:"string"},description:""},registrerProsessPanel:{required:!0,tsType:{name:"signature",type:"function",raw:"(data: ProsessPanelMenyData) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  id: string;
  tekst?: string;
  erAktiv?: boolean;
  harApentAksjonspunkt?: boolean;
  status?: string;
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"tekst",value:{name:"string",required:!1}},{key:"erAktiv",value:{name:"boolean",required:!1}},{key:"harApentAksjonspunkt",value:{name:"boolean",required:!1}},{key:"status",value:{name:"string",required:!1}}]}},name:"data"}],return:{name:"void"}}},description:""}}};Y.__docgenInfo={description:"",methods:[],displayName:"ProsessDefaultInitOverstyringPanel",props:{skalPanelVisesIMeny:{required:!0,tsType:{name:"boolean"},description:""},hentOverstyrtStatus:{required:!1,tsType:{name:"string"},description:""},prosessPanelKode:{required:!0,tsType:{name:"ProsessStegCode"},description:""},prosessPanelMenyTekst:{required:!0,tsType:{name:"string"},description:""},hentSkalMarkeresSomAktiv:{required:!1,tsType:{name:"boolean"},description:""},standardPanelProps:{required:!0,tsType:{name:"StandardProsessPanelProps"},description:""},children:{required:!0,tsType:{name:"ReactElement"},description:""},valgtProsessSteg:{required:!1,tsType:{name:"string"},description:""},registrerProsessPanel:{required:!0,tsType:{name:"signature",type:"function",raw:"(data: ProsessPanelMenyData) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  id: string;
  tekst?: string;
  erAktiv?: boolean;
  harApentAksjonspunkt?: boolean;
  status?: string;
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"tekst",value:{name:"string",required:!1}},{key:"erAktiv",value:{name:"boolean",required:!1}},{key:"harApentAksjonspunkt",value:{name:"boolean",required:!1}},{key:"status",value:{name:"string",required:!1}}]}},name:"data"}],return:{name:"void"}}},description:""}}};const C="default",G="default",w=(e,t,n,s,d,i)=>l=>{const r=Array.isArray(l)?l:[l],k=r.map(a=>({"@type":a.kode,...a})),g={saksnummer:t.saksnummer,behandlingUuid:n.uuid,behandlingVersjon:n.versjon},o=e(r);if(i){const a=s.filter(u=>r.some(f=>f.kode===u.definisjon)),p=a.some(u=>u.aksjonspunktType===A.OVERSTYRING||u.aksjonspunktType===A.SAKSBEHANDLEROVERSTYRING);if(r.length===0)throw Error("Det har oppstått en teknisk feil ved lagring av aksjonspunkter. Meld feilen i Porten.");if(a.length===0||p)return i({...g,overstyrteAksjonspunktDtoer:k}).then(o)}return d({...g,bekreftedeAksjonspunktDtoer:k}).then(o)},H=(e,t)=>{if(e.length>0){const n=e.map(s=>s.vilkarStatus);return n.some(s=>s===c.IKKE_VURDERT)?c.IKKE_VURDERT:n.every(s=>s===c.OPPFYLT)?c.OPPFYLT:c.IKKE_OPPFYLT}return t.length>0?t.some(n=>V(n.status))?c.IKKE_VURDERT:c.OPPFYLT:c.IKKE_VURDERT},se=(e,t,n)=>{const{behandling:s,rettigheter:d,fagsak:i,lagreAksjonspunkter:l,lagreOverstyrteAksjonspunkter:r,alleKodeverk:k,oppdaterProsessStegOgFaktaPanelIUrl:g}=P.use(E),{aksjonspunkt:o,vilkår:a}=s,p=o&&e?o.filter(m=>e.some(T=>T===m.definisjon)):[],u=a&&t?a.filter(m=>t.some(T=>T===m.vilkarType)):[],f=U(s,u,d,!1),S=_(s,p),h=p.some(m=>m.status===M.OPPRETTET&&m.kanLoses),v=H(u,p),j=!p.some(m=>m.kanLoses)||c.OPPFYLT===v,b=w(n||(()=>()=>{g(G,C)}),i,s,p,l,r);return{fagsak:i,behandling:s,isAksjonspunktOpen:h,aksjonspunkter:p,vilkar:u,alleKodeverk:k,alleMerknaderFraBeslutter:S,isReadOnly:f,readOnlySubmitButton:j,submitCallback:b,status:v}};export{x as P,Y as a,N as b,U as e,_ as g,se as u};
