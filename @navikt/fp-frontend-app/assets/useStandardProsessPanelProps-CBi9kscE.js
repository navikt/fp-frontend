import{r as y,j as m,X as _,bB as M,bG as F,bH as K}from"./iframe-cq3mD3Ne.js";import{V as c}from"./vilkarUtfallType-vN0hVpa7.js";import{B as h}from"./FagsakIndex-lMwCIyuT.js";import{B as I,P as x}from"./BehandlingHenlagtPanel-BDm1s70p.js";import{V as B,R as T}from"./index.es-DWefHNvG.js";import{b as q,e as C}from"./index-BZKGqdZU.js";import{J as E}from"./fagsakApi-CExQJ-M-.js";const L=()=>{const[e,r]=y.useState([]),n=s=>{r(i=>{const t=[...i],a=t.findIndex(o=>o.id===s.id);return a>=0?t.splice(a,1,s):t.push(s),t})};return{prosessPanelMenyData:e.filter(s=>s.skalVisesIMeny),settProsessPanelMenyData:n}},V="_container_142tr_1",N="_meny_142tr_9",U="_stepArrowContainer_142tr_16",A={container:V,meny:N,stepArrowContainer:U},w=({valgtProsessSteg:e,valgtFaktaSteg:r,children:n})=>{const{oppdaterProsessStegOgFaktaPanelIUrl:s}=y.use(h),{behandling:i}=y.use(h),{prosessPanelMenyData:t,settProsessPanelMenyData:a}=L(),o=u=>{const p=t[u],d=p.erAktiv?void 0:p.id;s(d,r)},l=t.map(u=>{const p=G(u.status,u.harÅpentAksjonspunkt);return{label:u.tekst??"",isActive:u.erAktiv,type:p}});return m.jsxs("div",{className:A.container,children:[m.jsx("div",{className:A.meny,"data-testid":"prosess-meny",children:m.jsx(B,{steps:l,onClick:o,stepArrowContainerStyle:A.stepArrowContainer})}),m.jsx(Y,{valgtProsessSteg:e,settProsessPanelMenyData:a,prosessPanelMenyData:t,children:n}),i.behandlingHenlagt&&m.jsx(I,{valgtProsessSteg:e,settProsessPanelMenyData:a})]})},S=y.createContext({}),Y=e=>{const{children:r,...n}=e,s=y.useMemo(()=>n,[n]);return m.jsx(S.Provider,{value:s,children:r})},G=(e,r)=>r?T.warning:e===c.OPPFYLT?T.success:e===c.IKKE_OPPFYLT?T.danger:T.default;w.__docgenInfo={description:"",methods:[],displayName:"ProsessMeny",props:{valgtProsessSteg:{required:!0,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},valgtFaktaSteg:{required:!0,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},children:{required:!0,tsType:{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"},description:""}}};const H=(e,r)=>e!==_.BEHANDLING_UTREDES?{}:r.reduce((n,s)=>({...n,[s.definisjon]:{notAccepted:s.toTrinnsBehandling&&s.toTrinnsBehandlingGodkjent===!1}}),{}),J=e=>e.taskStatus?.readOnly??!1,W=(e,r,n,s)=>{const{behandlingPåVent:i}=e,t=s||J(e),a=r.some(o=>!o.overstyrbar);return!n.writeAccess.isEnabled||i||t||a},X="default",z=(e,r,n,s,i,t)=>{const{valgtProsessSteg:a,settProsessPanelMenyData:o}=y.use(S),l=n&&(a===e||t&&a===X);return y.useEffect(()=>{o({id:e,tekst:r,erAktiv:l,harÅpentAksjonspunkt:s,status:i,skalVisesIMeny:n})},[n,l,s,i]),n&&l},Q=e=>m.jsx(b,{...e,harÅpentAksjonspunkt:e.standardPanelProps.harÅpentAksjonspunkt}),Z=e=>{const{erOverstyrt:r}=M(),n=r||e.standardPanelProps.harÅpentAksjonspunkt;return m.jsx(b,{...e,harÅpentAksjonspunkt:n})},b=({overstyrtStatus:e,skalMarkeresSomAktiv:r,skalPanelVisesIMeny:n,prosessPanelKode:s,prosessPanelMenyTekst:i,standardPanelProps:t,harÅpentAksjonspunkt:a,children:o})=>{const{behandling:l,fagsak:u,alleKodeverk:p}=y.use(h),d=e??t.status,k=!!r&&!l.behandlingHenlagt,P=z(s,i,n,a,d,k||a),f=P&&(a||d!==c.IKKE_VURDERT);return m.jsx(F,{behandling:l,children:m.jsx(x,{erPanelValgt:P,harÅpentAksjonspunkt:t.harÅpentAksjonspunkt,status:d,children:f?m.jsx(K,{behandling:l,fagsak:u,aksjonspunkterForPanel:t.aksjonspunkterForPanel,harÅpentAksjonspunkt:t.harÅpentAksjonspunkt,alleKodeverk:p,submitCallback:t.submitCallback,isReadOnly:t.isReadOnly,alleMerknaderFraBeslutter:t.alleMerknaderFraBeslutter,isSubmittable:!t.readOnlySubmitButton,children:o}):null})})};Q.__docgenInfo={description:"",methods:[],displayName:"ProsessDefaultInitPanel",props:{skalPanelVisesIMeny:{required:!0,tsType:{name:"boolean"},description:""},overstyrtStatus:{required:!1,tsType:{name:"string"},description:""},prosessPanelKode:{required:!0,tsType:{name:"ProsessStegCode"},description:""},prosessPanelMenyTekst:{required:!0,tsType:{name:"string"},description:""},skalMarkeresSomAktiv:{required:!1,tsType:{name:"boolean"},description:""},standardPanelProps:{required:!0,tsType:{name:"StandardProsessPanelProps"},description:""},children:{required:!0,tsType:{name:"ReactElement"},description:""}}};Z.__docgenInfo={description:"",methods:[],displayName:"ProsessDefaultInitOverstyringPanel",props:{skalPanelVisesIMeny:{required:!0,tsType:{name:"boolean"},description:""},overstyrtStatus:{required:!1,tsType:{name:"string"},description:""},prosessPanelKode:{required:!0,tsType:{name:"ProsessStegCode"},description:""},prosessPanelMenyTekst:{required:!0,tsType:{name:"string"},description:""},skalMarkeresSomAktiv:{required:!1,tsType:{name:"boolean"},description:""},standardPanelProps:{required:!0,tsType:{name:"StandardProsessPanelProps"},description:""},children:{required:!0,tsType:{name:"ReactElement"},description:""}}};const $="default",ee="default",ce=(e=[],r=[],n)=>{const{behandling:s,rettigheter:i,fagsak:t,lagreAksjonspunkter:a,lagreOverstyrteAksjonspunkter:o,alleKodeverk:l,oppdaterProsessStegOgFaktaPanelIUrl:u}=y.use(h),{aksjonspunkt:p,vilkår:d}=s,k=p.filter(g=>e.includes(g.definisjon)),P=(d??[]).filter(g=>r.includes(g.vilkarType)),f=W(s,P,i,!1),D=H(s.status,k),j=k.some(g=>g.status===q.OPPRETTET&&g.kanLoses),v=ne(P,k),R=!k.some(g=>g.kanLoses)||c.OPPFYLT===v,O=se(n||(()=>()=>{u(ee,$)}),t,s,k,a,o);return{fagsak:t,behandling:s,harÅpentAksjonspunkt:j,isAksjonspunktOpen:j,aksjonspunkter:k,aksjonspunkterForPanel:k,vilkårForPanel:P,alleKodeverk:l,alleMerknaderFraBeslutter:D,isReadOnly:f,readOnlySubmitButton:R,submitCallback:O,status:v}},se=(e,r,n,s,i,t)=>a=>{const o=Array.isArray(a)?a:[a],l=o.map(d=>({"@type":d.kode,...d})),u={saksnummer:r.saksnummer,behandlingUuid:n.uuid,behandlingVersjon:n.versjon},p=e(o);if(t){const d=s.filter(P=>o.some(f=>f.kode===P.definisjon)),k=d.some(P=>P.aksjonspunktType===E.OVERSTYRING||P.aksjonspunktType===E.SAKSBEHANDLEROVERSTYRING);if(o.length===0)throw Error("Det har oppstått en teknisk feil ved lagring av aksjonspunkter. Meld feilen i Porten.");if(d.length===0||k)return t({...u,overstyrteAksjonspunktDtoer:l}).then(p)}return i({...u,bekreftedeAksjonspunktDtoer:l}).then(p)},ne=(e,r)=>{if(e.length>0){const n=e.map(s=>s.vilkarStatus);return n.some(s=>s===c.IKKE_VURDERT)?c.IKKE_VURDERT:n.every(s=>s===c.OPPFYLT)?c.OPPFYLT:c.IKKE_OPPFYLT}return r.length>0?r.some(C)?c.IKKE_VURDERT:c.OPPFYLT:c.IKKE_VURDERT};export{Q as P,w as a,Z as b,S as c,z as d,W as e,H as g,ce as u};
