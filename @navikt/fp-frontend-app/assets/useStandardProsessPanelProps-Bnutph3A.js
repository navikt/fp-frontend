import{r as y,j as P,$ as M,bB as F,bG as K,bH as I}from"./iframe-D6pyJFnd.js";import{V as p}from"./vilkarUtfallType-vN0hVpa7.js";import{B as h}from"./FagsakIndex-o3tOsTef.js";import{B as x,P as B}from"./BehandlingHenlagtPanel-BTy9pWlR.js";import{V as q,R as T}from"./index.es-BaCD9xWv.js";import{b as C,i as L}from"./index-DJW2GNZM.js";import{K as E}from"./fagsakApi-jjFtvP3u.js";const V=()=>{const[s,t]=y.useState([]),n=e=>{t(i=>{const r=[...i],a=r.findIndex(o=>o.id===e.id);return a>=0?r.splice(a,1,e):r.push(e),r})};return{prosessPanelMenyData:s.filter(e=>e.skalVisesImeny),settProsessPanelMenyData:n}},N="_container_142tr_1",U="_meny_142tr_9",w="_stepArrowContainer_142tr_16",j={container:N,meny:U,stepArrowContainer:w},Y=({valgtProsessSteg:s,valgtFaktaSteg:t,children:n})=>{const{oppdaterProsessStegOgFaktaPanelIUrl:e}=y.use(h),{behandling:i}=y.use(h),{prosessPanelMenyData:r,settProsessPanelMenyData:a}=V(),o=d=>{const c=r[d],u=c.erAktiv?void 0:c.id;e(u,t)},l=r.map(d=>{const c=H(d.status,d.harApentAksjonspunkt);return{label:d.tekst??"",isActive:d.erAktiv,type:c}});return P.jsxs("div",{className:j.container,children:[P.jsx("div",{className:j.meny,"data-testid":"prosess-meny",children:P.jsx(q,{steps:l,onClick:o,stepArrowContainerStyle:j.stepArrowContainer})}),P.jsx(G,{valgtProsessSteg:s,settProsessPanelMenyData:a,prosessPanelMenyData:r,children:n}),i.behandlingHenlagt&&P.jsx(x,{valgtProsessSteg:s,settProsessPanelMenyData:a})]})},S=y.createContext({}),G=s=>{const{children:t,...n}=s,e=y.useMemo(()=>n,[n]);return P.jsx(S.Provider,{value:e,children:t})},H=(s,t)=>t?T.warning:s===p.OPPFYLT?T.success:s===p.IKKE_OPPFYLT?T.danger:T.default;Y.__docgenInfo={description:"",methods:[],displayName:"ProsessMeny",props:{valgtProsessSteg:{required:!0,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},valgtFaktaSteg:{required:!0,tsType:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]},description:""},children:{required:!0,tsType:{name:"Array",elements:[{name:"ReactNode"}],raw:"ReactNode[]"},description:""}}};const W=(s,t)=>s!==M.BEHANDLING_UTREDES?{}:t.reduce((n,e)=>({...n,[e.definisjon]:{notAccepted:e.toTrinnsBehandling&&e.toTrinnsBehandlingGodkjent===!1}}),{}),$=s=>s.taskStatus?.readOnly??!1,z=(s,t,n,e)=>{const{behandlingPåVent:i}=s,r=e||$(s),a=t.some(o=>!o.overstyrbar);return!n.writeAccess.isEnabled||i||r||a},J="default",Q=(s,t,n,e,i,r)=>{const{valgtProsessSteg:a,settProsessPanelMenyData:o}=y.use(S),l=n&&(a===s||r&&a===J);return y.useEffect(()=>{o({id:s,tekst:t,erAktiv:l,harApentAksjonspunkt:e,status:i,skalVisesImeny:n})},[n,l,e,i]),n&&l},X=s=>{const{standardPanelProps:t}=s,n=t.harÅpneAksjonspunkter;return P.jsx(D,{...s,harApentAksjonspunkt:n})},Z=s=>{const{erOverstyrt:t}=F(),{standardPanelProps:n}=s,e=t||n.harÅpneAksjonspunkter;return P.jsx(D,{...s,harApentAksjonspunkt:e})},D=({overstyrtStatus:s,skalMarkeresSomAktiv:t,skalPanelVisesIMeny:n,prosessPanelKode:e,prosessPanelMenyTekst:i,standardPanelProps:r,harApentAksjonspunkt:a,children:o})=>{const{behandling:l,fagsak:d,alleKodeverk:c}=y.use(h),u=s??r.status,m=!!t&&!l.behandlingHenlagt,k=Q(e,i,n,a,u,m||a),f=k&&(a||u!==p.IKKE_VURDERT);return P.jsx(K,{behandling:l,children:P.jsx(B,{erPanelValgt:k,erAksjonspunktOpent:r.harÅpneAksjonspunkter,status:u,children:f?P.jsx(I,{behandling:l,fagsak:d,aksjonspunkterForPanel:r.aksjonspunkterForPanel,harÅpneAksjonspunkter:r.harÅpneAksjonspunkter,alleKodeverk:c,submitCallback:r.submitCallback,isReadOnly:r.isReadOnly,alleMerknaderFraBeslutter:r.alleMerknaderFraBeslutter,children:o}):null})})};X.__docgenInfo={description:"",methods:[],displayName:"ProsessDefaultInitPanel",props:{skalPanelVisesIMeny:{required:!0,tsType:{name:"boolean"},description:""},overstyrtStatus:{required:!1,tsType:{name:"string"},description:""},prosessPanelKode:{required:!0,tsType:{name:"ProsessStegCode"},description:""},prosessPanelMenyTekst:{required:!0,tsType:{name:"string"},description:""},skalMarkeresSomAktiv:{required:!1,tsType:{name:"boolean"},description:""},standardPanelProps:{required:!0,tsType:{name:"StandardProsessPanelProps"},description:""},children:{required:!0,tsType:{name:"ReactElement"},description:""}}};Z.__docgenInfo={description:"",methods:[],displayName:"ProsessDefaultInitOverstyringPanel",props:{skalPanelVisesIMeny:{required:!0,tsType:{name:"boolean"},description:""},overstyrtStatus:{required:!1,tsType:{name:"string"},description:""},prosessPanelKode:{required:!0,tsType:{name:"ProsessStegCode"},description:""},prosessPanelMenyTekst:{required:!0,tsType:{name:"string"},description:""},skalMarkeresSomAktiv:{required:!1,tsType:{name:"boolean"},description:""},standardPanelProps:{required:!0,tsType:{name:"StandardProsessPanelProps"},description:""},children:{required:!0,tsType:{name:"ReactElement"},description:""}}};const ee="default",se="default",ne=(s,t,n,e,i,r)=>a=>{const o=Array.isArray(a)?a:[a],l=o.map(u=>({"@type":u.kode,...u})),d={saksnummer:t.saksnummer,behandlingUuid:n.uuid,behandlingVersjon:n.versjon},c=s(o);if(r){const u=e.filter(k=>o.some(f=>f.kode===k.definisjon)),m=u.some(k=>k.aksjonspunktType===E.OVERSTYRING||k.aksjonspunktType===E.SAKSBEHANDLEROVERSTYRING);if(o.length===0)throw Error("Det har oppstått en teknisk feil ved lagring av aksjonspunkter. Meld feilen i Porten.");if(u.length===0||m)return r({...d,overstyrteAksjonspunktDtoer:l}).then(c)}return i({...d,bekreftedeAksjonspunktDtoer:l}).then(c)},te=(s,t)=>{if(s.length>0){const n=s.map(e=>e.vilkarStatus);return n.some(e=>e===p.IKKE_VURDERT)?p.IKKE_VURDERT:n.every(e=>e===p.OPPFYLT)?p.OPPFYLT:p.IKKE_OPPFYLT}return t.length>0?t.some(n=>L(n.status))?p.IKKE_VURDERT:p.OPPFYLT:p.IKKE_VURDERT},pe=(s=[],t=[],n)=>{const{behandling:e,rettigheter:i,fagsak:r,lagreAksjonspunkter:a,lagreOverstyrteAksjonspunkter:o,alleKodeverk:l,oppdaterProsessStegOgFaktaPanelIUrl:d}=y.use(h),{aksjonspunkt:c,vilkår:u}=e,m=c?c.filter(g=>s.some(A=>A===g.definisjon)):[],k=u&&t?u.filter(g=>t.some(A=>A===g.vilkarType)):[],f=z(e,k,i,!1),R=W(e.status,m),O=m.some(g=>g.status===C.OPPRETTET&&g.kanLoses),v=te(k,m),_=!m.some(g=>g.kanLoses)||p.OPPFYLT===v,b=ne(n||(()=>()=>{d(se,ee)}),r,e,m,a,o);return{fagsak:r,behandling:e,harÅpneAksjonspunkter:O,aksjonspunkterForPanel:m,vilkar:k,alleKodeverk:l,alleMerknaderFraBeslutter:R,isReadOnly:f,readOnlySubmitButton:_,submitCallback:b,status:v}};export{X as P,Y as a,Z as b,S as c,Q as d,z as e,W as g,pe as u};
