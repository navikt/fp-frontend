import{j as y}from"./jsx-runtime-D_zvdyIk.js";import{r as P}from"./index-DjhIdADd.js";import{d as b,A as q,y as D,z as K}from"./withPanelData-D-X8cCe-.js";import{V as c,P as U}from"./BehandlingHenlagtPanel-DmWrCzxm.js";import"./skjermlenkeCodes-1SvLTuBb.js";import{a as S}from"./behandlingDataContext-BnLc3C0Q.js";import{U as F}from"./index.es-CaW1D0zu.js";import{A as L,i as M}from"./aksjonspunktStatus-xM4O_ZUY.js";var E=(e=>(e.MANUELL="MANU",e.AUTOPUNKT="AUTO",e.OVERSTYRING="OVST",e.SAKSBEHANDLEROVERSTYRING="SAOV",e))(E||{});const V=(e,t)=>e.status!==b.BEHANDLING_UTREDES?{}:t.reduce((n,s)=>({...n,[s.definisjon]:{notAccepted:s.toTrinnsBehandling&&s.toTrinnsBehandlingGodkjent===!1}}),{}),_=e=>{var t;return((t=e.taskStatus)==null?void 0:t.readOnly)??!1},I=(e,t,n,s)=>{const{behandlingPaaVent:d}=e,i=s||_(e),u=t.some(r=>!r.overstyrbar);return!n.writeAccess.isEnabled||d||i||u},B="default",N=(e,t,n,s,d,i,u,r)=>{const[p,g]=P.useState(!1);P.useEffect(()=>{e({id:t})},[]);const a=s&&(r===t||u&&r===B),o=F(s);return P.useEffect(()=>{s?e({id:t,tekst:n,erAktiv:a,harApentAksjonspunkt:d,status:i}):!s&&o&&e({id:t}),g(a)},[s,o,a,d,i]),s&&p},x=e=>{const{standardPanelProps:t}=e,n=t.isAksjonspunktOpen;return y.jsx(h,{...e,harApentAksjonspunkt:n})},C=e=>{const{erOverstyrt:t}=q(),{standardPanelProps:n}=e,s=t||n.isAksjonspunktOpen;return y.jsx(h,{...e,harApentAksjonspunkt:s})},h=({valgtProsessSteg:e,hentOverstyrtStatus:t,registrerProsessPanel:n,hentSkalMarkeresSomAktiv:s,skalPanelVisesIMeny:d,prosessPanelKode:i,prosessPanelMenyTekst:u,standardPanelProps:r,harApentAksjonspunkt:p,children:g})=>{const{behandling:a,fagsak:o,alleKodeverk:k}=P.use(S),l=t??r.status,f=!!s&&!a.behandlingHenlagt,T=N(n,i,u,d,p,l,f||p,e),A=T&&(p||l!==c.IKKE_VURDERT);return y.jsx(D,{behandling:a,children:y.jsx(U,{erPanelValgt:T,erAksjonspunktOpent:r.isAksjonspunktOpen,status:l,children:A?y.jsx(K,{behandling:a,fagsak:o,aksjonspunkterForPanel:r.aksjonspunkter,harÅpneAksjonspunkter:r.isAksjonspunktOpen,alleKodeverk:k,submitCallback:r.submitCallback,isReadOnly:r.isReadOnly,alleMerknaderFraBeslutter:r.alleMerknaderFraBeslutter,children:g}):null})})};x.__docgenInfo={description:"",methods:[],displayName:"ProsessDefaultInitPanel",props:{skalPanelVisesIMeny:{required:!0,tsType:{name:"boolean"},description:""},hentOverstyrtStatus:{required:!1,tsType:{name:"string"},description:""},prosessPanelKode:{required:!0,tsType:{name:"ProsessStegCode"},description:""},prosessPanelMenyTekst:{required:!0,tsType:{name:"string"},description:""},hentSkalMarkeresSomAktiv:{required:!1,tsType:{name:"boolean"},description:""},standardPanelProps:{required:!0,tsType:{name:"StandardProsessPanelProps"},description:""},children:{required:!0,tsType:{name:"ReactElement"},description:""},valgtProsessSteg:{required:!1,tsType:{name:"string"},description:""},registrerProsessPanel:{required:!0,tsType:{name:"signature",type:"function",raw:"(data: ProsessPanelMenyData) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  id: string;
  tekst?: string;
  erAktiv?: boolean;
  harApentAksjonspunkt?: boolean;
  status?: string;
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"tekst",value:{name:"string",required:!1}},{key:"erAktiv",value:{name:"boolean",required:!1}},{key:"harApentAksjonspunkt",value:{name:"boolean",required:!1}},{key:"status",value:{name:"string",required:!1}}]}},name:"data"}],return:{name:"void"}}},description:""}}};C.__docgenInfo={description:"",methods:[],displayName:"ProsessDefaultInitOverstyringPanel",props:{skalPanelVisesIMeny:{required:!0,tsType:{name:"boolean"},description:""},hentOverstyrtStatus:{required:!1,tsType:{name:"string"},description:""},prosessPanelKode:{required:!0,tsType:{name:"ProsessStegCode"},description:""},prosessPanelMenyTekst:{required:!0,tsType:{name:"string"},description:""},hentSkalMarkeresSomAktiv:{required:!1,tsType:{name:"boolean"},description:""},standardPanelProps:{required:!0,tsType:{name:"StandardProsessPanelProps"},description:""},children:{required:!0,tsType:{name:"ReactElement"},description:""},valgtProsessSteg:{required:!1,tsType:{name:"string"},description:""},registrerProsessPanel:{required:!0,tsType:{name:"signature",type:"function",raw:"(data: ProsessPanelMenyData) => void",signature:{arguments:[{type:{name:"signature",type:"object",raw:`{
  id: string;
  tekst?: string;
  erAktiv?: boolean;
  harApentAksjonspunkt?: boolean;
  status?: string;
}`,signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"tekst",value:{name:"string",required:!1}},{key:"erAktiv",value:{name:"boolean",required:!1}},{key:"harApentAksjonspunkt",value:{name:"boolean",required:!1}},{key:"status",value:{name:"string",required:!1}}]}},name:"data"}],return:{name:"void"}}},description:""}}};const Y="default",G="default",w=(e,t,n,s,d,i)=>u=>{const r=Array.isArray(u)?u:[u],p=r.map(o=>({"@type":o.kode,...o})),g={saksnummer:t.saksnummer,behandlingUuid:n.uuid,behandlingVersjon:n.versjon},a=e(r);if(i){const o=s.filter(l=>r.some(f=>f.kode===l.definisjon)),k=o.some(l=>l.aksjonspunktType===E.OVERSTYRING||l.aksjonspunktType===E.SAKSBEHANDLEROVERSTYRING);if(r.length===0)throw Error("Det har oppstått en teknisk feil ved lagring av aksjonspunkter. Meld feilen i Porten.");if(o.length===0||k)return i({...g,overstyrteAksjonspunktDtoer:p}).then(a)}return d({...g,bekreftedeAksjonspunktDtoer:p}).then(a)},H=(e,t)=>{if(e.length>0){const n=e.map(s=>s.vilkarStatus);return n.some(s=>s===c.IKKE_VURDERT)?c.IKKE_VURDERT:n.every(s=>s===c.OPPFYLT)?c.OPPFYLT:c.IKKE_OPPFYLT}return t.length>0?t.some(n=>M(n.status))?c.IKKE_VURDERT:c.OPPFYLT:c.IKKE_VURDERT},te=(e,t,n)=>{const{behandling:s,rettigheter:d,fagsak:i,lagreAksjonspunkter:u,lagreOverstyrteAksjonspunkter:r,alleKodeverk:p,oppdaterProsessStegOgFaktaPanelIUrl:g}=P.use(S),{aksjonspunkt:a,vilkår:o}=s,k=a&&e?a.filter(m=>e.some(v=>v===m.definisjon)):[],l=o&&t?o.filter(m=>t.some(v=>v===m.vilkarType)):[],f=I(s,l,d,!1),T=V(s,k),A=k.some(m=>m.status===L.OPPRETTET&&m.kanLoses),O=H(l,k),j=!k.some(m=>m.kanLoses)||c.OPPFYLT===O,R=w(n||(()=>()=>{g(G,Y)}),i,s,k,u,r);return{fagsak:i,behandling:s,isAksjonspunktOpen:A,aksjonspunkter:k,vilkar:l,alleKodeverk:p,alleMerknaderFraBeslutter:T,isReadOnly:f,readOnlySubmitButton:j,submitCallback:R,status:O}};export{x as P,C as a,N as b,I as e,V as g,te as u};
